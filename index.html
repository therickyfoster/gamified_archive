<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planetary Restoration Archive - Neural Navigation System</title>
    <meta name="description" content="AI-powered exploration platform for planetary restoration projects with advanced gamification and real-world impact tracking">
    
    <!-- Zero-Harm Declaration -->
    <!-- 
    INTENDED USE: Educational exploration, planetary restoration coordination, peaceful collaboration
    NON-WEAPONIZATION: This tool is designed for restoration, not extraction or harm
    LICENSE: Open-source under MIT - attribute Foster + Navi / Planetary Restoration Archive
    SAFETY: Client-side rate limiting, input sanitization, privacy-first design
    -->
    
    <style>
        /* ═══════════════════════════════════════════════════════════════
           CORE FOUNDATION STYLES
           What: Base typography, reset, CSS variables for theming
           How: Import-free, self-contained, responsive foundation
           Expected: Consistent rendering across all modern browsers
           ═══════════════════════════════════════════════════════════════ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Cosmic Theme (Default) */
            --bg-primary: #0a0e27;
            --bg-secondary: #151b3d;
            --bg-tertiary: #1e2749;
            --text-primary: #e0e6ff;
            --text-secondary: #a0aed0;
            --accent-primary: #6366f1;
            --accent-secondary: #8b5cf6;
            --accent-success: #10b981;
            --accent-warning: #f59e0b;
            --accent-danger: #ef4444;
            --border-color: #2d3a5f;
            --shadow: rgba(99, 102, 241, 0.2);
            
            /* Gamification Colors */
            --xp-color: #fbbf24;
            --level-color: #a78bfa;
            --achievement-color: #34d399;
            --quest-color: #60a5fa;
            
            /* Spacing System */
            --space-xs: 0.25rem;
            --space-sm: 0.5rem;
            --space-md: 1rem;
            --space-lg: 1.5rem;
            --space-xl: 2rem;
            --space-2xl: 3rem;
            
            /* Animation Timing */
            --transition-fast: 150ms ease;
            --transition-base: 250ms ease;
            --transition-slow: 500ms ease;
        }

        /* Medieval Theme */
        [data-theme="medieval"] {
            --bg-primary: #1a0f0a;
            --bg-secondary: #2d1810;
            --bg-tertiary: #3d2318;
            --text-primary: #f4e4d7;
            --text-secondary: #c4a88a;
            --accent-primary: #d4af37;
            --accent-secondary: #8b4513;
            --border-color: #5d3a1a;
        }

        /* Anime Theme */
        [data-theme="anime"] {
            --bg-primary: #fff5f7;
            --bg-secondary: #ffe4e9;
            --bg-tertiary: #ffd1dc;
            --text-primary: #2d1b2e;
            --text-secondary: #5d4a5e;
            --accent-primary: #ff6b9d;
            --accent-secondary: #c060ff;
            --border-color: #ffb3d4;
        }

        /* Regenerative Theme */
        [data-theme="regen"] {
            --bg-primary: #0a1f0a;
            --bg-secondary: #1a2f1a;
            --bg-tertiary: #2a3f2a;
            --text-primary: #e0ffe0;
            --text-secondary: #a0d0a0;
            --accent-primary: #4ade80;
            --accent-secondary: #22c55e;
            --border-color: #2d5f2d;
        }

        /* Matrix Theme */
        [data-theme="matrix"] {
            --bg-primary: #000000;
            --bg-secondary: #001100;
            --bg-tertiary: #002200;
            --text-primary: #00ff00;
            --text-secondary: #00aa00;
            --accent-primary: #00ff00;
            --accent-secondary: #00cc00;
            --border-color: #003300;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            transition: background-color var(--transition-slow), color var(--transition-slow);
        }

        /* ═══════════════════════════════════════════════════════════════
           ULTRA-DETAILED GAMIFICATION HUD SYSTEM
           What: Comprehensive MMO-style interface with multiple stat displays
           How: Fixed position panels, expandable sections, resource tracking
           Expected: Always visible, rich feedback, professional MMO feel
           ═══════════════════════════════════════════════════════════════ */
        .hud-container {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 9999;
            pointer-events: none;
        }

        .hud-top {
            display: flex;
            justify-content: space-between;
            padding: var(--space-md);
            gap: var(--space-md);
            flex-wrap: wrap;
        }

        .hud-panel {
            background: rgba(21, 27, 61, 0.95);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: var(--space-sm) var(--space-md);
            backdrop-filter: blur(10px);
            pointer-events: all;
            transition: all var(--transition-base);
            box-shadow: 0 4px 20px var(--shadow);
        }

        .hud-panel:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 30px var(--shadow);
        }

        .hud-panel.expandable {
            cursor: pointer;
        }

        .hud-panel.expanded {
            min-width: 300px;
        }

        .hud-stat {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            font-size: 0.9rem;
            font-weight: 600;
        }

        .hud-stat-icon {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .progress-bar {
            width: 150px;
            height: 8px;
            background: var(--bg-tertiary);
            border-radius: 4px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
            transition: width var(--transition-base);
            position: relative;
            overflow: hidden;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .level-badge {
            background: linear-gradient(135deg, var(--level-color), var(--accent-secondary));
            color: white;
            padding: var(--space-xs) var(--space-sm);
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.8rem;
            text-shadow: 0 1px 2px rgba(0,0,0,0.3);
        }

        /* Resource Bars (Health/Energy/Focus styled) */
        .resource-bar {
            width: 120px;
            height: 12px;
            background: var(--bg-tertiary);
            border-radius: 6px;
            overflow: hidden;
            position: relative;
            border: 1px solid rgba(0,0,0,0.3);
        }

        .resource-fill {
            height: 100%;
            transition: width var(--transition-base);
            position: relative;
        }

        .resource-fill.health {
            background: linear-gradient(90deg, #ef4444, #dc2626);
        }

        .resource-fill.energy {
            background: linear-gradient(90deg, #3b82f6, #2563eb);
        }

        .resource-fill.focus {
            background: linear-gradient(90deg, #a855f7, #9333ea);
        }

        /* Character Sheet Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 10000;
            display: none;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal-content {
            background: var(--bg-secondary);
            border: 3px solid var(--border-color);
            border-radius: 16px;
            max-width: 1200px;
            max-height: 90vh;
            overflow-y: auto;
            padding: var(--space-xl);
            position: relative;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
        }

        .modal-close {
            position: absolute;
            top: var(--space-md);
            right: var(--space-md);
            background: var(--accent-danger);
            color: white;
            border: none;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            cursor: pointer;
            font-size: 1.2rem;
            line-height: 1;
        }

        .modal-tabs {
            display: flex;
            gap: var(--space-sm);
            margin-bottom: var(--space-xl);
            border-bottom: 2px solid var(--border-color);
        }

        .modal-tab {
            padding: var(--space-md) var(--space-lg);
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-weight: 600;
            transition: all var(--transition-fast);
            border-bottom: 3px solid transparent;
        }

        .modal-tab.active {
            color: var(--accent-primary);
            border-bottom-color: var(--accent-primary);
        }

        .modal-tab:hover {
            color: var(--text-primary);
        }

        /* Skill Tree */
        .skill-tree {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--space-lg);
        }

        .skill-branch {
            background: var(--bg-tertiary);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: var(--space-lg);
        }

        .skill-node {
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: var(--space-md);
            margin-bottom: var(--space-md);
            position: relative;
            transition: all var(--transition-base);
        }

        .skill-node.locked {
            opacity: 0.5;
            filter: grayscale(1);
        }

        .skill-node.unlocked {
            border-color: var(--accent-success);
            box-shadow: 0 0 20px rgba(16, 185, 129, 0.2);
        }

        .skill-node.available {
            border-color: var(--accent-warning);
            animation: pulse-glow 2s infinite;
        }

        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 10px var(--accent-warning); }
            50% { box-shadow: 0 0 25px var(--accent-warning); }
        }

        /* Inventory System */
        .inventory-grid {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: var(--space-sm);
        }

        .inventory-slot {
            aspect-ratio: 1;
            background: var(--bg-tertiary);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            cursor: pointer;
            transition: all var(--transition-fast);
            position: relative;
        }

        .inventory-slot:hover {
            border-color: var(--accent-primary);
            transform: scale(1.05);
        }

        .inventory-slot.empty {
            opacity: 0.3;
        }

        .item-count {
            position: absolute;
            bottom: 2px;
            right: 4px;
            background: rgba(0,0,0,0.8);
            color: white;
            font-size: 0.7rem;
            padding: 1px 4px;
            border-radius: 3px;
        }

        .item-quality-common { border-color: #9ca3af; }
        .item-quality-uncommon { border-color: #10b981; }
        .item-quality-rare { border-color: #3b82f6; }
        .item-quality-epic { border-color: #a855f7; }
        .item-quality-legendary { border-color: #f59e0b; }

        /* Reputation/Faction System */
        .faction-list {
            display: flex;
            flex-direction: column;
            gap: var(--space-md);
        }

        .faction-item {
            background: var(--bg-tertiary);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: var(--space-md);
        }

        .faction-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-sm);
        }

        .faction-name {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            font-weight: 600;
        }

        .reputation-level {
            font-size: 0.85rem;
            padding: var(--space-xs) var(--space-sm);
            border-radius: 6px;
            font-weight: 600;
        }

        .rep-hostile { background: #7f1d1d; color: #fca5a5; }
        .rep-unfriendly { background: #991b1b; color: #fecaca; }
        .rep-neutral { background: #78716c; color: #d6d3d1; }
        .rep-friendly { background: #065f46; color: #6ee7b7; }
        .rep-honored { background: #065f46; color: #34d399; }
        .rep-revered { background: #1e40af; color: #60a5fa; }
        .rep-exalted { background: #6b21a8; color: #c084fc; }

        /* Daily Habits (Habitica-style) */
        .habit-list {
            display: flex;
            flex-direction: column;
            gap: var(--space-sm);
        }

        .habit-item {
            background: var(--bg-tertiary);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: var(--space-md);
            display: flex;
            align-items: center;
            gap: var(--space-md);
        }

        .habit-buttons {
            display: flex;
            gap: var(--space-xs);
        }

        .habit-btn {
            width: 36px;
            height: 36px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all var(--transition-fast);
        }

        .habit-btn.plus {
            background: var(--accent-success);
            color: white;
        }

        .habit-btn.minus {
            background: var(--accent-danger);
            color: white;
        }

        .habit-btn:hover {
            transform: scale(1.1);
        }

        .habit-streak {
            background: var(--accent-warning);
            color: white;
            padding: var(--space-xs) var(--space-sm);
            border-radius: 6px;
            font-weight: 600;
            font-size: 0.85rem;
        }

        /* Companion System (SWTOR-style) */
        .companion-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: var(--space-lg);
        }

        .companion-card {
            background: var(--bg-tertiary);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: var(--space-md);
            text-align: center;
            transition: all var(--transition-base);
            cursor: pointer;
        }

        .companion-card.active {
            border-color: var(--accent-success);
            box-shadow: 0 0 20px rgba(16, 185, 129, 0.3);
        }

        .companion-card:hover {
            transform: translateY(-4px);
        }

        .companion-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            margin: 0 auto var(--space-md);
        }

        .companion-affection {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-xs);
            margin-top: var(--space-sm);
        }

        .affection-heart {
            color: var(--accent-danger);
            font-size: 1.2rem;
        }

        .affection-heart.filled {
            color: #ef4444;
        }

        .affection-heart.empty {
            color: var(--border-color);
        }

        /* Mount/Vehicle System */
        .mount-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: var(--space-md);
        }

        .mount-card {
            background: var(--bg-tertiary);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: var(--space-md);
            text-align: center;
            cursor: pointer;
            transition: all var(--transition-base);
        }

        .mount-card.unlocked:hover {
            border-color: var(--accent-primary);
            transform: scale(1.05);
        }

        .mount-card.locked {
            opacity: 0.4;
            filter: grayscale(1);
        }

        .mount-icon {
            font-size: 3rem;
            margin-bottom: var(--space-sm);
        }

        .mount-speed {
            color: var(--accent-warning);
            font-weight: 600;
            font-size: 0.85rem;
        }

        /* Title System (LOTRO-style) */
        .title-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: var(--space-md);
        }

        .title-card {
            background: var(--bg-tertiary);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: var(--space-md);
            cursor: pointer;
            transition: all var(--transition-base);
        }

        .title-card.unlocked {
            border-color: var(--accent-success);
        }

        .title-card.equipped {
            background: linear-gradient(135deg, var(--bg-tertiary), rgba(99, 102, 241, 0.2));
            border-color: var(--accent-primary);
        }

        .title-card.locked {
            opacity: 0.5;
        }

        .title-text {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--accent-primary);
            text-align: center;
            margin-bottom: var(--space-sm);
        }

        /* Crafting System */
        .crafting-recipe {
            background: var(--bg-tertiary);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: var(--space-md);
            margin-bottom: var(--space-md);
        }

        .recipe-ingredients {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-sm);
            margin: var(--space-md) 0;
        }

        .ingredient {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: var(--space-xs) var(--space-sm);
            font-size: 0.85rem;
        }

        .ingredient.have {
            border-color: var(--accent-success);
        }

        .ingredient.need {
            border-color: var(--accent-danger);
        }

        .craft-btn {
            width: 100%;
            padding: var(--space-sm) var(--space-md);
            background: var(--accent-primary);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .craft-btn:hover:not(:disabled) {
            background: var(--accent-secondary);
            transform: scale(1.02);
        }

        .craft-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Achievement Toast */
        .achievement-toast {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            z-index: 10001;
            background: linear-gradient(135deg, var(--achievement-color), var(--accent-success));
            color: white;
            padding: var(--space-xl);
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            text-align: center;
            min-width: 400px;
            animation: achievementToast 4s ease-in-out;
        }

        @keyframes achievementToast {
            0% { transform: translate(-50%, -50%) scale(0) rotate(-180deg); opacity: 0; }
            10% { transform: translate(-50%, -50%) scale(1.2) rotate(10deg); opacity: 1; }
            15% { transform: translate(-50%, -50%) scale(1) rotate(0); }
            85% { transform: translate(-50%, -50%) scale(1) rotate(0); opacity: 1; }
            100% { transform: translate(-50%, -50%) scale(0) rotate(180deg); opacity: 0; }
        }

        /* Stat Comparison Tooltips */
        .stat-tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.95);
            border: 2px solid var(--accent-primary);
            border-radius: 8px;
            padding: var(--space-md);
            font-size: 0.85rem;
            z-index: 10002;
            pointer-events: none;
            opacity: 0;
            transition: opacity var(--transition-fast);
            min-width: 200px;
        }

        .stat-tooltip.visible {
            opacity: 1;
        }

        /* ═══════════════════════════════════════════════════════════════
           PARALLAX CONSTELLATION BACKGROUND
           What: Animated starfield with mouse-following parallax effect
           How: Canvas-based particle system, requestAnimationFrame loop
           Expected: Smooth 60fps animation, responsive to mouse movement
           ═══════════════════════════════════════════════════════════════ */
        #constellation-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            pointer-events: none;
        }

        /* ═══════════════════════════════════════════════════════════════
           MAIN NAVIGATION & LAYOUT
           What: Sticky header, responsive sidebar, main content area
           How: Flexbox layout, transforms for mobile menu
           Expected: Smooth transitions, accessible keyboard navigation
           ═══════════════════════════════════════════════════════════════ */
        .main-header {
            position: sticky;
            top: 0;
            z-index: 1000;
            background: rgba(21, 27, 61, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 2px solid var(--border-color);
            padding: var(--space-md) var(--space-lg);
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: var(--space-lg);
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .theme-selector {
            display: flex;
            gap: var(--space-sm);
        }

        .theme-btn {
            padding: var(--space-sm) var(--space-md);
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all var(--transition-fast);
            font-size: 0.9rem;
        }

        .theme-btn:hover {
            background: var(--accent-primary);
            transform: translateY(-2px);
        }

        .theme-btn.active {
            background: var(--accent-primary);
            border-color: var(--accent-primary);
        }

        .main-container {
            display: flex;
            max-width: 1400px;
            margin: 0 auto;
            padding: var(--space-xl);
            gap: var(--space-xl);
            position: relative;
            z-index: 1;
        }

        /* ═══════════════════════════════════════════════════════════════
           AI ASSISTANT PANEL
           What: Collapsible AI chat interface with suggestions
           How: Streaming responses, context-aware recommendations
           Expected: Natural conversation flow, helpful project insights
           ═══════════════════════════════════════════════════════════════ */
        .ai-assistant {
            width: 350px;
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: 16px;
            padding: var(--space-lg);
            position: sticky;
            top: calc(80px + var(--space-md));
            height: fit-content;
            max-height: calc(100vh - 120px);
            overflow-y: auto;
            box-shadow: 0 10px 40px var(--shadow);
        }

        .ai-header {
            display: flex;
            align-items: center;
            gap: var(--space-md);
            margin-bottom: var(--space-lg);
            padding-bottom: var(--space-md);
            border-bottom: 2px solid var(--border-color);
        }

        .ai-avatar {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.8; }
        }

        .ai-chat {
            display: flex;
            flex-direction: column;
            gap: var(--space-md);
            margin-bottom: var(--space-md);
            min-height: 200px;
        }

        .ai-message {
            padding: var(--space-md);
            border-radius: 12px;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .ai-message.assistant {
            background: var(--bg-tertiary);
            border-left: 3px solid var(--accent-primary);
        }

        .ai-message.user {
            background: var(--accent-primary);
            color: white;
            align-self: flex-end;
        }

        .ai-suggestions {
            display: flex;
            flex-direction: column;
            gap: var(--space-sm);
            margin-top: var(--space-md);
        }

        .suggestion-btn {
            padding: var(--space-sm) var(--space-md);
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all var(--transition-fast);
            text-align: left;
            font-size: 0.9rem;
        }

        .suggestion-btn:hover {
            background: var(--accent-primary);
            color: white;
            transform: translateX(5px);
        }

        .ai-input-container {
            display: flex;
            gap: var(--space-sm);
            margin-top: var(--space-md);
        }

        .ai-input {
            flex: 1;
            padding: var(--space-sm) var(--space-md);
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 0.9rem;
        }

        .ai-send-btn {
            padding: var(--space-sm) var(--space-md);
            background: var(--accent-primary);
            border: none;
            border-radius: 8px;
            color: white;
            cursor: pointer;
            transition: all var(--transition-fast);
            font-weight: 600;
        }

        .ai-send-btn:hover {
            background: var(--accent-secondary);
            transform: scale(1.05);
        }

        /* ═══════════════════════════════════════════════════════════════
           CONTENT EXPLORER
           What: Main browsing interface with search, filters, cards
           How: Grid layout, lazy loading, virtual scrolling for performance
           Expected: Fast filtering, smooth scrolling, responsive cards
           ═══════════════════════════════════════════════════════════════ */
        .content-main {
            flex: 1;
            min-width: 0;
        }

        .search-bar {
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: var(--space-md);
            margin-bottom: var(--space-xl);
            display: flex;
            gap: var(--space-md);
            flex-wrap: wrap;
        }

        .search-input {
            flex: 1;
            min-width: 250px;
            padding: var(--space-sm) var(--space-md);
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 1rem;
        }

        .search-input::placeholder {
            color: var(--text-secondary);
        }

        .filter-group {
            display: flex;
            gap: var(--space-sm);
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: var(--space-sm) var(--space-md);
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all var(--transition-fast);
            font-size: 0.9rem;
        }

        .filter-btn:hover {
            background: var(--accent-primary);
            color: white;
        }

        .filter-btn.active {
            background: var(--accent-primary);
            color: white;
            border-color: var(--accent-primary);
        }

        .content-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: var(--space-lg);
            margin-bottom: var(--space-xl);
        }

        /* ═══════════════════════════════════════════════════════════════
           PROJECT CARDS
           What: Individual project displays with hover effects, badges
           How: CSS Grid layout, transform animations, gradient overlays
           Expected: Interactive hover states, clear visual hierarchy
           ═══════════════════════════════════════════════════════════════ */
        .project-card {
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: 16px;
            padding: var(--space-lg);
            transition: all var(--transition-base);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .project-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
            transform: scaleX(0);
            transition: transform var(--transition-base);
        }

        .project-card:hover::before {
            transform: scaleX(1);
        }

        .project-card:hover {
            transform: translateY(-8px);
            border-color: var(--accent-primary);
            box-shadow: 0 12px 40px var(--shadow);
        }

        .project-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: var(--space-md);
        }

        .project-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--space-xs);
        }

        .project-category {
            display: inline-block;
            padding: var(--space-xs) var(--space-sm);
            background: var(--accent-primary);
            color: white;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .project-description {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: var(--space-md);
            line-height: 1.6;
        }

        .project-tags {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-sm);
            margin-bottom: var(--space-md);
        }

        .tag {
            padding: var(--space-xs) var(--space-sm);
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .project-stats {
            display: flex;
            justify-content: space-between;
            padding-top: var(--space-md);
            border-top: 1px solid var(--border-color);
            font-size: 0.85rem;
        }

        .stat {
            display: flex;
            align-items: center;
            gap: var(--space-xs);
            color: var(--text-secondary);
        }

        /* ═══════════════════════════════════════════════════════════════
           QUEST & ACHIEVEMENT SYSTEMS
           What: Gamified task tracking, unlockable achievements
           How: Progress tracking, conditional rendering, animations
           Expected: Motivating feedback, clear progression path
           ═══════════════════════════════════════════════════════════════ */
        .quests-panel {
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: 16px;
            padding: var(--space-lg);
            margin-bottom: var(--space-xl);
        }

        .quest-item {
            background: var(--bg-tertiary);
            border-radius: 12px;
            padding: var(--space-md);
            margin-bottom: var(--space-md);
            border-left: 4px solid var(--quest-color);
        }

        .quest-item:last-child {
            margin-bottom: 0;
        }

        .quest-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-sm);
        }

        .quest-title {
            font-weight: 600;
            color: var(--text-primary);
        }

        .quest-reward {
            color: var(--xp-color);
            font-weight: 600;
            font-size: 0.9rem;
        }

        .quest-progress {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            margin-top: var(--space-sm);
        }

        .achievement-badge {
            display: inline-flex;
            align-items: center;
            gap: var(--space-sm);
            padding: var(--space-sm) var(--space-md);
            background: linear-gradient(135deg, var(--achievement-color), var(--accent-success));
            color: white;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 600;
            animation: achievementPop 0.5s ease;
        }

        @keyframes achievementPop {
            0% { transform: scale(0) rotate(-180deg); opacity: 0; }
            50% { transform: scale(1.2) rotate(10deg); }
            100% { transform: scale(1) rotate(0); opacity: 1; }
        }

        /* ═══════════════════════════════════════════════════════════════
           DISCOVERY & TRAIT SYSTEM
           What: Dynamic class/trait assignment based on exploration
           How: Pattern recognition, behavior tracking, skill trees
           Expected: Personalized experience, meaningful progression
           ═══════════════════════════════════════════════════════════════ */
        .discovery-panel {
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: 16px;
            padding: var(--space-lg);
            margin-bottom: var(--space-xl);
        }

        .trait-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: var(--space-md);
        }

        .trait-card {
            background: var(--bg-tertiary);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: var(--space-md);
            text-align: center;
            transition: all var(--transition-base);
            position: relative;
            overflow: hidden;
        }

        .trait-card.unlocked {
            border-color: var(--accent-success);
            background: linear-gradient(135deg, var(--bg-tertiary), rgba(16, 185, 129, 0.1));
        }

        .trait-card.locked {
            opacity: 0.5;
            filter: grayscale(1);
        }

        .trait-icon {
            font-size: 2rem;
            margin-bottom: var(--space-sm);
        }

        .trait-name {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--space-xs);
        }

        .trait-description {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        /* ═══════════════════════════════════════════════════════════════
           RESPONSIVE DESIGN
           What: Mobile-first breakpoints, touch optimization
           How: Media queries, flexible layouts, larger touch targets
           Expected: Seamless experience across all device sizes
           ═══════════════════════════════════════════════════════════════ */
        @media (max-width: 1200px) {
            .main-container {
                flex-direction: column;
            }

            .ai-assistant {
                width: 100%;
                position: relative;
                top: 0;
                max-height: 400px;
            }

            .content-grid {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            }
        }

        @media (max-width: 768px) {
            .hud-top {
                flex-direction: column;
                gap: var(--space-sm);
            }

            .hud-panel {
                width: 100%;
            }

            .main-container {
                padding: var(--space-md);
            }

            .search-bar {
                flex-direction: column;
            }

            .content-grid {
                grid-template-columns: 1fr;
            }

            .trait-container {
                grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            }
        }

        /* ═══════════════════════════════════════════════════════════════
           ACCESSIBILITY ENHANCEMENTS
           What: Screen reader support, keyboard navigation, focus states
           How: ARIA labels, focus-visible, skip links, semantic HTML
           Expected: WCAG 2.1 AA compliance, full keyboard access
           ═══════════════════════════════════════════════════════════════ */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: var(--accent-primary);
            color: white;
            padding: var(--space-sm) var(--space-md);
            text-decoration: none;
            z-index: 10000;
        }

        .skip-link:focus {
            top: 0;
        }

        *:focus-visible {
            outline: 3px solid var(--accent-primary);
            outline-offset: 2px;
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }

        /* ═══════════════════════════════════════════════════════════════
           PRINT STYLES
           What: Optimized layout for PDF export and printing
           How: Remove backgrounds, adjust colors, page breaks
           Expected: Clean, readable printed documents
           ═══════════════════════════════════════════════════════════════ */
        @media print {
            .hud-container,
            .ai-assistant,
            .search-bar,
            #constellation-canvas,
            .theme-selector,
            .filter-group {
                display: none !important;
            }

            body {
                background: white;
                color: black;
            }

            .project-card {
                break-inside: avoid;
                border: 1px solid #ccc;
                page-break-inside: avoid;
            }

            .main-container {
                max-width: 100%;
            }
        }

        /* ═══════════════════════════════════════════════════════════════
           LOADING & ERROR STATES
           What: Skeleton screens, error messages, loading spinners
           How: CSS animations, conditional rendering
           Expected: Smooth loading experience, clear error communication
           ═══════════════════════════════════════════════════════════════ */
        .loading-spinner {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 4px solid var(--bg-tertiary);
            border-top-color: var(--accent-primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .error-message {
            background: rgba(239, 68, 68, 0.1);
            border: 2px solid var(--accent-danger);
            border-radius: 12px;
            padding: var(--space-lg);
            color: var(--accent-danger);
            text-align: center;
        }

        .skeleton {
            background: linear-gradient(90deg, var(--bg-tertiary) 25%, var(--bg-secondary) 50%, var(--bg-tertiary) 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
            border-radius: 8px;
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* ═══════════════════════════════════════════════════════════════
           EXPORT & SHARING
           What: Download buttons, share options, format selectors
           How: Blob generation, clipboard API, social sharing
           Expected: Easy content export in multiple formats
           ═══════════════════════════════════════════════════════════════ */
        .export-panel {
            position: fixed;
            bottom: var(--space-lg);
            right: var(--space-lg);
            display: flex;
            gap: var(--space-sm);
            z-index: 1000;
        }

        .export-btn {
            padding: var(--space-md);
            background: var(--accent-primary);
            color: white;
            border: none;
            border-radius: 50%;
            width: 56px;
            height: 56px;
            cursor: pointer;
            transition: all var(--transition-base);
            box-shadow: 0 4px 12px var(--shadow);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .export-btn:hover {
            transform: translateY(-4px) scale(1.1);
            box-shadow: 0 8px 24px var(--shadow);
        }

        /* ═══════════════════════════════════════════════════════════════
           NOSCRIPT FALLBACK
           What: Graceful degradation for users without JavaScript
           How: Static HTML content, basic styling
           Expected: Readable content, clear upgrade message
           ═══════════════════════════════════════════════════════════════ */
        noscript {
            display: block;
            padding: var(--space-xl);
            background: var(--accent-warning);
            color: white;
            text-align: center;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <!-- Skip Navigation Link for Accessibility -->
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <!-- Parallax Constellation Background -->
    <canvas id="constellation-canvas" aria-hidden="true"></canvas>

    <!-- Ultra-Detailed Gamification HUD -->
    <div class="hud-container" role="complementary" aria-label="Gamification Status">
        <div class="hud-top">
            <!-- Character Info Panel -->
            <div class="hud-panel" onclick="openCharacterSheet()" style="cursor: pointer;" title="Click to open Character Sheet">
                <div class="hud-stat">
                    <span class="hud-stat-icon">🎭</span>
                    <div style="display: flex; flex-direction: column; gap: 2px;">
                        <div style="display: flex; align-items: center; gap: var(--space-sm);">
                            <span class="level-badge" id="level-display">Level 1</span>
                            <span id="class-display" style="font-weight: 600;">Explorer</span>
                        </div>
                        <div style="font-size: 0.75rem; color: var(--text-secondary);" id="title-display">the Wanderer</div>
                    </div>
                </div>
            </div>

            <!-- XP & Resources Panel -->
            <div class="hud-panel">
                <div style="display: flex; flex-direction: column; gap: var(--space-xs);">
                    <div class="hud-stat">
                        <span class="hud-stat-icon">⭐</span>
                        <span style="min-width: 80px;">XP: <strong id="xp-current">0</strong>/<span id="xp-needed">100</span></span>
                        <div class="progress-bar">
                            <div class="progress-fill" id="xp-progress" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="hud-stat">
                        <span class="hud-stat-icon" style="color: #ef4444;">❤️</span>
                        <span style="min-width: 80px; font-size: 0.85rem;">Health</span>
                        <div class="resource-bar">
                            <div class="resource-fill health" id="health-bar" style="width: 100%"></div>
                        </div>
                    </div>
                    <div class="hud-stat">
                        <span class="hud-stat-icon" style="color: #3b82f6;">⚡</span>
                        <span style="min-width: 80px; font-size: 0.85rem;">Energy</span>
                        <div class="resource-bar">
                            <div class="resource-fill energy" id="energy-bar" style="width: 100%"></div>
                        </div>
                    </div>
                    <div class="hud-stat">
                        <span class="hud-stat-icon" style="color: #a855f7;">🧠</span>
                        <span style="min-width: 80px; font-size: 0.85rem;">Focus</span>
                        <div class="resource-bar">
                            <div class="resource-fill focus" id="focus-bar" style="width: 100%"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Stats & Currency Panel -->
            <div class="hud-panel expandable" onclick="togglePanel(this)">
                <div class="hud-stat">
                    <span class="hud-stat-icon">💰</span>
                    <div style="display: flex; flex-direction: column; gap: var(--space-xs);">
                        <div><strong id="gold-count">0</strong> 🪙 Gold</div>
                        <div style="font-size: 0.85rem; color: var(--text-secondary);"><strong id="silver-count">0</strong> Crystals</div>
                    </div>
                </div>
                <div class="panel-expanded" style="display: none; margin-top: var(--space-sm); padding-top: var(--space-sm); border-top: 1px solid var(--border-color);">
                    <div style="font-size: 0.85rem; color: var(--text-secondary);">
                        <div>⚔️ Power: <strong id="power-stat">10</strong></div>
                        <div>🛡️ Resilience: <strong id="resilience-stat">10</strong></div>
                        <div>🔮 Wisdom: <strong id="wisdom-stat">10</strong></div>
                    </div>
                </div>
            </div>

            <!-- Achievements & Quests Panel -->
            <div class="hud-panel expandable" onclick="togglePanel(this)">
                <div class="hud-stat">
                    <span class="hud-stat-icon">🏆</span>
                    <span><strong id="achievement-count">0</strong> Achievements</span>
                    <span class="hud-stat-icon">📜</span>
                    <span><strong id="quest-count">3</strong> Quests</span>
                </div>
                <div class="panel-expanded" style="display: none; margin-top: var(--space-sm); padding-top: var(--space-sm); border-top: 1px solid var(--border-color);">
                    <div style="font-size: 0.85rem; color: var(--text-secondary);">
                        <div>📊 Completion: <strong id="completion-percent">0</strong>%</div>
                        <div>🎯 Daily Streak: <strong id="daily-streak">0</strong> days</div>
                    </div>
                </div>
            </div>

            <!-- Companion Status -->
            <div class="hud-panel" onclick="openCharacterSheet('companions')" style="cursor: pointer;" title="Active Companion">
                <div class="hud-stat">
                    <span class="hud-stat-icon" id="active-companion-icon">🤖</span>
                    <div style="display: flex; flex-direction: column; gap: 2px;">
                        <div style="font-size: 0.85rem; font-weight: 600;" id="active-companion-name">Navi</div>
                        <div style="font-size: 0.75rem; color: var(--text-secondary);">
                            <span id="companion-affection">❤️❤️❤️🤍🤍</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Character Sheet Modal -->
    <div class="modal-overlay" id="character-sheet-modal" onclick="if(event.target === this) closeCharacterSheet()">
        <div class="modal-content">
            <button class="modal-close" onclick="closeCharacterSheet()">×</button>
            
            <h1 style="font-size: 2rem; margin-bottom: var(--space-lg); background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                Character Sheet
            </h1>

            <div class="modal-tabs">
                <button class="modal-tab active" onclick="switchTab('stats')">📊 Stats</button>
                <button class="modal-tab" onclick="switchTab('skills')">🌳 Skills</button>
                <button class="modal-tab" onclick="switchTab('inventory')">🎒 Inventory</button>
                <button class="modal-tab" onclick="switchTab('companions')">👥 Companions</button>
                <button class="modal-tab" onclick="switchTab('mounts')">🐎 Mounts</button>
                <button class="modal-tab" onclick="switchTab('titles')">🏅 Titles</button>
                <button class="modal-tab" onclick="switchTab('factions')">⚔️ Factions</button>
                <button class="modal-tab" onclick="switchTab('crafting')">⚒️ Crafting</button>
                <button class="modal-tab" onclick="switchTab('habits')">✅ Habits</button>
            </div>

            <div id="tab-content">
                <!-- Content populated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Main Header -->
    <header class="main-header">
        <div class="header-content">
            <div class="logo">🌍 Planetary Restoration Archive</div>
            <div class="theme-selector" role="group" aria-label="Theme selection">
                <button class="theme-btn active" data-theme="cosmic" onclick="setTheme('cosmic')">Cosmic</button>
                <button class="theme-btn" data-theme="medieval" onclick="setTheme('medieval')">Medieval</button>
                <button class="theme-btn" data-theme="anime" onclick="setTheme('anime')">Anime</button>
                <button class="theme-btn" data-theme="regen" onclick="setTheme('regen')">Regenerative</button>
                <button class="theme-btn" data-theme="matrix" onclick="setTheme('matrix')">Matrix</button>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <main class="main-container" id="main-content">
        <!-- AI Assistant Panel -->
        <aside class="ai-assistant" role="complementary" aria-label="AI Assistant">
            <div class="ai-header">
                <div class="ai-avatar" aria-hidden="true">🤖</div>
                <div>
                    <h2 style="font-size: 1.2rem; margin-bottom: 0.25rem;">Navi</h2>
                    <p style="font-size: 0.85rem; color: var(--text-secondary);">Your Restoration Guide</p>
                </div>
            </div>

            <div class="ai-chat" id="ai-chat" role="log" aria-live="polite" aria-atomic="false">
                <div class="ai-message assistant">
                    Welcome, Steward! I'm Navi, your AI guide through the Planetary Restoration Archive. I can help you discover projects, suggest learning paths, and provide insights based on your interests. What would you like to explore today?
                </div>
            </div>

            <div class="ai-suggestions">
                <h3 style="font-size: 0.9rem; margin-bottom: var(--space-sm); color: var(--text-secondary);">Quick Actions</h3>
                <button class="suggestion-btn" onclick="aiSuggest('projects')">🔍 Show me restoration projects</button>
                <button class="suggestion-btn" onclick="aiSuggest('quests')">🎯 What quests should I start?</button>
                <button class="suggestion-btn" onclick="aiSuggest('traits')">✨ Help me discover my traits</button>
                <button class="suggestion-btn" onclick="aiSuggest('impact')">🌱 Show my real-world impact</button>
            </div>

            <div class="ai-input-container">
                <input type="text" class="ai-input" id="ai-input" placeholder="Ask Navi anything..." aria-label="AI assistant input">
                <button class="ai-send-btn" onclick="sendToAI()" aria-label="Send message">Send</button>
            </div>
        </aside>

        <!-- Main Content Area -->
        <section class="content-main">
            <!-- Search & Filter Bar -->
            <div class="search-bar" role="search">
                <input type="search" class="search-input" id="search-input" placeholder="Search projects, topics, or locations..." aria-label="Search content">
                <div class="filter-group" role="group" aria-label="Content filters">
                    <button class="filter-btn active" data-filter="all" onclick="filterContent('all')">All</button>
                    <button class="filter-btn" data-filter="peace" onclick="filterContent('peace')">Peace</button>
                    <button class="filter-btn" data-filter="regen" onclick="filterContent('regen')">Regeneration</button>
                    <button class="filter-btn" data-filter="crisis" onclick="filterContent('crisis')">Crisis Response</button>
                    <button class="filter-btn" data-filter="governance" onclick="filterContent('governance')">Governance</button>
                    <button class="filter-btn" data-filter="education" onclick="filterContent('education')">Education</button>
                </div>
            </div>

            <!-- Active Quests Panel -->
            <div class="quests-panel" id="quests-panel">
                <h2 style="margin-bottom: var(--space-lg); display: flex; align-items: center; gap: var(--space-sm);">
                    <span style="font-size: 1.5rem;">🎯</span>
                    Active Quests
                </h2>
                <div id="quests-container">
                    <!-- Quests populated by JavaScript -->
                </div>
            </div>

            <!-- Trait Discovery Panel -->
            <div class="discovery-panel" id="discovery-panel">
                <h2 style="margin-bottom: var(--space-lg); display: flex; align-items: center; gap: var(--space-sm);">
                    <span style="font-size: 1.5rem;">✨</span>
                    Your Discovered Traits
                </h2>
                <div class="trait-container" id="traits-container">
                    <!-- Traits populated by JavaScript -->
                </div>
            </div>

            <!-- Project Grid -->
            <div class="content-grid" id="content-grid">
                <!-- Projects populated by JavaScript -->
            </div>
        </section>
    </main>

    <!-- Export Panel -->
    <div class="export-panel">
        <button class="export-btn" onclick="exportData('html')" aria-label="Export as HTML" title="Export as HTML">
            💾
        </button>
        <button class="export-btn" onclick="exportData('json')" aria-label="Export as JSON" title="Export as JSON">
            📊
        </button>
        <button class="export-btn" onclick="window.print()" aria-label="Print or export as PDF" title="Print/PDF">
            🖨️
        </button>
    </div>

    <!-- Noscript Fallback -->
    <noscript>
        <strong>JavaScript Required:</strong> This application requires JavaScript for full functionality. Please enable JavaScript in your browser settings to explore the Planetary Restoration Archive.
    </noscript>

    <!-- ═══════════════════════════════════════════════════════════════
         JAVASCRIPT APPLICATION LOGIC
         What: Core app functionality, data management, AI integration
         How: Modular functions, async operations, IndexedDB persistence
         Expected: Fast, responsive, offline-capable experience
         ═══════════════════════════════════════════════════════════════ -->
    <script>
        // ═══════════════════════════════════════════════════════════════
        // DATA MODELS & STATE MANAGEMENT
        // What: Central data store, user profile, project catalog
        // How: JavaScript objects, IndexedDB for persistence
        // Expected: Fast access, automatic saving, data integrity
        // ═══════════════════════════════════════════════════════════════
        
        // ═══════════════════════════════════════════════════════════════
        // ULTRA-DETAILED GAME STATE MANAGEMENT
        // What: Comprehensive MMO-style data structures
        // How: Nested objects, arrays, multiple progression systems
        // Expected: All game systems tracked, persistent, interlinked
        // ═══════════════════════════════════════════════════════════════
        
        const appState = {
            user: {
                // Core Stats
                xp: 0,
                level: 1,
                class: 'Explorer',
                spec: null, // Class specialization
                
                // Resources (0-100)
                health: 100,
                maxHealth: 100,
                energy: 100,
                maxEnergy: 100,
                focus: 100,
                maxFocus: 100,
                
                // Currency
                gold: 0,
                crystals: 0, // Premium currency
                tokens: {}, // Special event tokens
                
                // Core Attributes (WOW-style)
                stats: {
                    power: 10,      // Increases quest rewards
                    resilience: 10, // Reduces penalty from failures
                    wisdom: 10,     // Faster learning, better insights
                    charisma: 10,   // Better faction gains
                    luck: 10        // Random bonuses
                },
                
                // Secondary Stats
                derived: {
                    critChance: 5,
                    xpBonus: 0,
                    goldFind: 0,
                    explorationSpeed: 100
                },
                
                // Title System (LOTRO-style)
                titles: {
                    unlocked: ['the Wanderer'],
                    equipped: 'the Wanderer',
                    prefix: null // "Sir", "Lady", etc.
                },
                
                // Collections
                achievements: [],
                visitedProjects: [],
                unlockedTraits: [],
                discoveredLocations: [],
                completedQuests: [],
                
                // Progression Tracking
                dailyStreak: 0,
                lastLoginDate: null,
                totalPlayTime: 0,
                
                // Active Buffs/Debuffs
                buffs: [],
                
                // Mount System
                activeMount: null,
                mountSpeed: 0
            },
            
            // Skill Trees (SWTOR-style branching)
            skills: {
                exploration: {
                    name: 'Exploration',
                    icon: '🔍',
                    nodes: [
                        { id: 'scout', name: 'Scout', level: 1, unlocked: true, maxLevel: 3, currentLevel: 0, description: 'Reveal hidden project insights', effect: 'showDetails' },
                        { id: 'cartographer', name: 'Cartographer', level: 5, unlocked: false, maxLevel: 3, currentLevel: 0, description: '+10% XP from new locations', effect: 'xpBonus', requires: ['scout'] },
                        { id: 'pathfinder', name: 'Pathfinder', level: 10, unlocked: false, maxLevel: 5, currentLevel: 0, description: 'Unlock fast travel between projects', effect: 'fastTravel', requires: ['cartographer'] }
                    ]
                },
                restoration: {
                    name: 'Restoration',
                    icon: '🌱',
                    nodes: [
                        { id: 'gardener', name: 'Gardener', level: 1, unlocked: true, maxLevel: 3, currentLevel: 0, description: 'Earn resources from regen projects', effect: 'resourceGain' },
                        { id: 'cultivator', name: 'Cultivator', level: 5, unlocked: false, maxLevel: 3, currentLevel: 0, description: 'Double resources from specific biomes', effect: 'doubleResources', requires: ['gardener'] },
                        { id: 'lifebringer', name: 'Lifebringer', level: 15, unlocked: false, maxLevel: 1, currentLevel: 0, description: 'Ultimate: Heal all resources instantly', effect: 'ultimate', requires: ['cultivator'] }
                    ]
                },
                diplomacy: {
                    name: 'Diplomacy',
                    icon: '🕊️',
                    nodes: [
                        { id: 'mediator', name: 'Mediator', level: 1, unlocked: true, maxLevel: 3, currentLevel: 0, description: '+20% faction reputation gain', effect: 'factionBonus' },
                        { id: 'ambassador', name: 'Ambassador', level: 8, unlocked: false, maxLevel: 3, currentLevel: 0, description: 'Access to faction vendors', effect: 'vendorAccess', requires: ['mediator'] },
                        { id: 'unifier', name: 'Unifier', level: 20, unlocked: false, maxLevel: 1, currentLevel: 0, description: 'Legendary: Unite all factions', effect: 'legendary', requires: ['ambassador'] }
                    ]
                },
                knowledge: {
                    name: 'Knowledge',
                    icon: '📚',
                    nodes: [
                        { id: 'student', name: 'Student', level: 1, unlocked: true, maxLevel: 3, currentLevel: 0, description: 'Learn faster from educational content', effect: 'learningSpeed' },
                        { id: 'scholar', name: 'Scholar', level: 6, unlocked: false, maxLevel: 3, currentLevel: 0, description: 'Unlock advanced research projects', effect: 'advancedAccess', requires: ['student'] },
                        { id: 'sage', name: 'Sage', level: 18, unlocked: false, maxLevel: 1, currentLevel: 0, description: 'Master: All knowledge grants wisdom', effect: 'masterKnowledge', requires: ['scholar'] }
                    ]
                }
            },
            
            // Inventory System (WOW-style)
            inventory: {
                maxSlots: 32,
                items: [
                    // Example items
                    { id: 'scroll_peace', name: 'Scroll of Peace', icon: '📜', quality: 'uncommon', count: 3, description: 'Grants +50 reputation with Peace factions', usable: true },
                    { id: 'crystal_focus', name: 'Focus Crystal', icon: '💎', quality: 'rare', count: 1, description: 'Restores 50 Focus instantly', usable: true },
                    { id: 'seed_hope', name: 'Seeds of Hope', icon: '🌱', quality: 'common', count: 15, description: 'Crafting material for restoration projects', usable: false }
                ]
            },
            
            // Companion System (SWTOR-style)
            companions: [
                {
                    id: 'navi',
                    name: 'Navi',
                    icon: '🤖',
                    role: 'Guide',
                    affection: 3, // 0-5 hearts
                    maxAffection: 5,
                    level: 1,
                    active: true,
                    unlocked: true,
                    bonus: { type: 'xp', value: 10 },
                    story: 'An AI companion dedicated to planetary restoration',
                    gifts: ['knowledge', 'technology']
                },
                {
                    id: 'terra',
                    name: 'Terra',
                    icon: '🌍',
                    role: 'Earth Spirit',
                    affection: 0,
                    maxAffection: 5,
                    level: 1,
                    active: false,
                    unlocked: false,
                    unlockRequirement: 'Visit 10 restoration projects',
                    bonus: { type: 'restoration', value: 25 },
                    story: 'Ancient earth spirit awakened by restoration efforts',
                    gifts: ['nature', 'crystals']
                },
                {
                    id: 'phoenix',
                    name: 'Phoenix',
                    icon: '🔥',
                    role: 'Transformation',
                    affection: 0,
                    maxAffection: 5,
                    level: 1,
                    active: false,
                    unlocked: false,
                    unlockRequirement: 'Complete 5 crisis response projects',
                    bonus: { type: 'energy', value: 20 },
                    story: 'Mythical bird of renewal and hope',
                    gifts: ['courage', 'determination']
                },
                {
                    id: 'sage',
                    name: 'Elder Sage',
                    icon: '🧙',
                    role: 'Wisdom',
                    affection: 0,
                    maxAffection: 5,
                    level: 1,
                    active: false,
                    unlocked: false,
                    unlockRequirement: 'Reach level 10',
                    bonus: { type: 'wisdom', value: 5 },
                    story: 'Ancient keeper of forgotten knowledge',
                    gifts: ['books', 'artifacts']
                }
            ],
            
            // Mount/Vehicle System
            mounts: [
                { id: 'walk', name: 'Walking', icon: '🚶', speed: 100, unlocked: true, description: 'Your own two feet' },
                { id: 'bicycle', name: 'Bicycle', icon: '🚲', speed: 150, unlocked: false, requirement: 'Reach level 5', cost: 100 },
                { id: 'horse', name: 'Swift Horse', icon: '🐎', speed: 200, unlocked: false, requirement: 'Honored with any faction', cost: 500 },
                { id: 'griffin', name: 'Griffin', icon: '🦅', speed: 300, unlocked: false, requirement: 'Complete 50 projects', cost: 2000 },
                { id: 'dragon', name: 'Ancient Dragon', icon: '🐉', speed: 400, unlocked: false, requirement: 'Exalted with 3 factions', cost: 10000 }
            ],
            
            // Faction/Reputation System
            factions: [
                {
                    id: 'peacekeeper_alliance',
                    name: 'Peacekeeper Alliance',
                    icon: '🕊️',
                    reputation: 0,
                    level: 'Neutral',
                    description: 'Dedicated to conflict resolution and harmony',
                    rewards: {
                        'Friendly': { title: 'Friend of Peace', item: 'peace_banner' },
                        'Honored': { mount: 'white_dove', discount: 10 },
                        'Revered': { skill: 'peaceful_aura', item: 'mediator_staff' },
                        'Exalted': { title: 'Peacemaker Supreme', mount: 'phoenix' }
                    }
                },
                {
                    id: 'restoration_circle',
                    name: 'Restoration Circle',
                    icon: '🌱',
                    reputation: 0,
                    level: 'Neutral',
                    description: 'Guardians of ecological balance',
                    rewards: {
                        'Friendly': { title: 'Steward', item: 'seedbag' },
                        'Honored': { recipe: 'growth_potion', discount: 10 },
                        'Revered': { companion: 'terra', item: 'staff_of_growth' },
                        'Exalted': { title: 'Lifebringer', mount: 'tree_spirit' }
                    }
                },
                {
                    id: 'knowledge_keepers',
                    name: 'Knowledge Keepers',
                    icon: '📚',
                    reputation: 0,
                    level: 'Neutral',
                    description: 'Preservers of wisdom and learning',
                    rewards: {
                        'Friendly': { title: 'Scholar', xpBonus: 5 },
                        'Honored': { item: 'ancient_tome', skill: 'speed_reading' },
                        'Revered': { companion: 'sage', item: 'crystal_of_wisdom' },
                        'Exalted': { title: 'Grand Sage', legendary: 'book_of_ages' }
                    }
                },
                {
                    id: 'crisis_responders',
                    name: 'Crisis Responders',
                    icon: '🚨',
                    reputation: 0,
                    level: 'Neutral',
                    description: 'First to act in times of need',
                    rewards: {
                        'Friendly': { title: 'First Responder', item: 'emergency_kit' },
                        'Honored': { mount: 'rescue_chopper', discount: 15 },
                        'Revered': { skill: 'rapid_deployment', companion: 'phoenix' },
                        'Exalted': { title: 'Guardian Angel', legendary: 'beacon_of_hope' }
                    }
                }
            ],
            
            // Crafting System
            crafting: {
                professions: [
                    {
                        id: 'restoration_crafting',
                        name: 'Ecological Restoration',
                        icon: '🌿',
                        level: 1,
                        xp: 0,
                        maxLevel: 100
                    },
                    {
                        id: 'knowledge_synthesis',
                        name: 'Knowledge Synthesis',
                        icon: '🔬',
                        level: 1,
                        xp: 0,
                        maxLevel: 100
                    }
                ],
                recipes: [
                    {
                        id: 'healing_potion',
                        name: 'Restoration Elixir',
                        icon: '🧪',
                        ingredients: [
                            { id: 'seed_hope', count: 5 },
                            { id: 'water_pure', count: 1 }
                        ],
                        result: { id: 'healing_potion', count: 1 },
                        profession: 'restoration_crafting',
                        level: 1,
                        unlocked: true
                    },
                    {
                        id: 'xp_scroll',
                        name: 'Scroll of Wisdom',
                        icon: '📜',
                        ingredients: [
                            { id: 'paper_ancient', count: 3 },
                            { id: 'ink_mystic', count: 1 }
                        ],
                        result: { id: 'xp_scroll', count: 1 },
                        profession: 'knowledge_synthesis',
                        level: 5,
                        unlocked: false
                    }
                ]
            },
            
            // Daily Habits (Habitica-style)
            habits: [
                {
                    id: 'daily_visit',
                    name: 'Explore New Projects',
                    icon: '🔍',
                    type: 'daily',
                    positive: true,
                    negative: true,
                    streak: 0,
                    value: 0, // -10 to +10
                    xpReward: 10,
                    goldReward: 5
                },
                {
                    id: 'learn_something',
                    name: 'Learn Something New',
                    icon: '📖',
                    type: 'daily',
                    positive: true,
                    negative: true,
                    streak: 0,
                    value: 0,
                    xpReward: 15,
                    goldReward: 8
                },
                {
                    id: 'share_knowledge',
                    name: 'Share Knowledge',
                    icon: '💬',
                    type: 'habit',
                    positive: true,
                    negative: false,
                    streak: 0,
                    value: 0,
                    xpReward: 5,
                    goldReward: 3
                },
                {
                    id: 'complete_quest',
                    name: 'Complete Daily Quest',
                    icon: '✅',
                    type: 'daily',
                    positive: true,
                    negative: true,
                    streak: 0,
                    value: 0,
                    xpReward: 25,
                    goldReward: 15
                }
            ],
            
            // Title Collection (LOTRO-style)
            titleCollection: [
                { id: 'wanderer', name: 'the Wanderer', unlocked: true, requirement: 'Default title' },
                { id: 'explorer', name: 'the Explorer', unlocked: false, requirement: 'Visit 10 projects' },
                { id: 'steward', name: 'Steward', unlocked: false, requirement: 'Complete 5 restoration projects' },
                { id: 'peacemaker', name: 'the Peacemaker', unlocked: false, requirement: 'Complete 5 peace projects' },
                { id: 'scholar', name: 'the Scholar', unlocked: false, requirement: 'Complete 5 education projects' },
                { id: 'hero', name: 'Hero of the Archive', unlocked: false, requirement: 'Reach level 20' },
                { id: 'legend', name: 'Living Legend', unlocked: false, requirement: 'Complete 100 projects' },
                { id: 'restorer', name: 'Planetary Restorer', unlocked: false, requirement: 'Exalted with Restoration Circle' },
                { id: 'guardian', name: 'Guardian of Hope', unlocked: false, requirement: 'Complete all crisis response projects' },
                { id: 'sage', name: 'Grand Sage', unlocked: false, requirement: 'Exalted with Knowledge Keepers' }
            ],
            
            projects: [],
            quests: [],
            traits: [],
            currentFilter: 'all',
            searchQuery: '',
            
            // Meta progression
            meta: {
                accountLevel: 1,
                accountXP: 0,
                legacyBonus: 0, // Bonus for alt characters
                collectibles: [],
                achievementPoints: 0
            }
        };

        // IndexedDB Setup
        let db;
        const dbName = 'PlanetaryArchiveDB';
        const dbVersion = 1;

        function initDB() {
            const request = indexedDB.open(dbName, dbVersion);
            
            request.onerror = () => {
                console.error('Database failed to open');
            };
            
            request.onsuccess = () => {
                db = request.result;
                loadFromDB();
            };
            
            request.onupgradeneeded = (e) => {
                db = e.target.result;
                
                if (!db.objectStoreNames.contains('userData')) {
                    db.createObjectStore('userData', { keyPath: 'id' });
                }
                
                if (!db.objectStoreNames.contains('projects')) {
                    db.createObjectStore('projects', { keyPath: 'url' });
                }
            };
        }

        function saveToDB(storeName, data) {
            if (!db) return;
            const transaction = db.transaction([storeName], 'readwrite');
            const objectStore = transaction.objectStore(storeName);
            objectStore.put(data);
        }

        function loadFromDB() {
            if (!db) return;
            
            const transaction = db.transaction(['userData'], 'readonly');
            const objectStore = transaction.objectStore('userData');
            const request = objectStore.get('currentUser');
            
            request.onsuccess = () => {
                if (request.result) {
                    appState.user = request.result.data;
                    updateHUD();
                }
            };
        }

        // ═══════════════════════════════════════════════════════════════
        // PROJECT DATA PARSING
        // What: Parse URL list into structured project data
        // How: Pattern matching, categorization, metadata extraction
        // Expected: Rich project cards with accurate categorization
        // ═══════════════════════════════════════════════════════════════
        
        const projectURLs = `https://planetaryrestorationarchive.com/YMM/proposal/1/index.html
https://planetaryrestorationarchive.com/ref/role/rare/index.html
https://planetaryrestorationarchive.com/ref/role/index.html
https://planetaryrestorationarchive.com/ref/meta/1/v1/index.html
https://planetaryrestorationarchive.com/ref/meta/1/v2/index.html
https://planetaryrestorationarchive.com/ref/meta/1/index.html
https://planetaryrestorationarchive.com/ref/meta/genesis/index.html
https://planetaryrestorationarchive.com/ref/meta/genesis/v2/index.html
https://planetaryrestorationarchive.com/ref/meta/genesis/v3/index.html
https://planetaryrestorationarchive.com/ref/meta/genesis/v4/index.html
https://planetaryrestorationarchive.com/ref/meta/genesis/v5/index.html
https://planetaryrestorationarchive.com/ref/crypto/sol/research/index.html
https://planetaryrestorationarchive.com/ref/crypto/sol/custom/gpt/rare/peace/engineer/hybrid/index.html
https://planetaryrestorationarchive.com/ref/theme/constellation/1/index.html
https://planetaryrestorationarchive.com/ref/loading/screen/regen/index.html
https://planetaryrestorationarchive.com/ref/splash/1/index.html
https://planetaryrestorationarchive.com/ref/splash/2/index.html
https://planetaryrestorationarchive.com/ref/custom/instructions/meta/systems/architect/index.html
https://planetaryrestorationarchive.com/ref/prompt/sovereign/index.html
https://planetaryrestorationarchive.com/ref/sommer/rise/index.html
https://planetaryrestorationarchive.com/ref/unity/protocol/index.html
https://planetaryrestorationarchive.com/ref/story/meta/v1/index.html
https://planetaryrestorationarchive.com/backup/multimodal/index.html
https://planetaryrestorationarchive.com/backup/pra-no-crypto/index.html
https://planetaryrestorationarchive.com/backup/index.html
https://planetaryrestorationarchive.com/hidden/prodigy/paradox/index.html
https://planetaryrestorationarchive.com/door/open/behind/us/index.html
https://planetaryrestorationarchive.com/education/index.html
https://planetaryrestorationarchive.com/education/app/index.html
https://planetaryrestorationarchive.com/education/tag/you/are/it/index.html
https://planetaryrestorationarchive.com/proof/index.html
https://planetaryrestorationarchive.com/proof/analysis/v2/index.html
https://planetaryrestorationarchive.com/proof/analysis/v3/index.html
https://planetaryrestorationarchive.com/proof/analysis/v4/index.html
https://planetaryrestorationarchive.com/proof/analysis/v5/index.html
https://planetaryrestorationarchive.com/proof/analysis/v1/index.html
https://planetaryrestorationarchive.com/proof/analysis/index.html
https://planetaryrestorationarchive.com/proof/guide/index.html
https://planetaryrestorationarchive.com/proof/guide/v1/index.html
https://planetaryrestorationarchive.com/proof/health/index.html
https://planetaryrestorationarchive.com/proof/military/index.html
https://planetaryrestorationarchive.com/proof/military/canada/index.html
https://planetaryrestorationarchive.com/proof/concept/earth/before/mars/v1/index.html
https://planetaryrestorationarchive.com/proof/concept/earth/before/mars/v2/index.html
https://planetaryrestorationarchive.com/proof/concept/earth/before/mars/v3/index.html
https://planetaryrestorationarchive.com/proof/concept/earth/before/mars/index.html
https://planetaryrestorationarchive.com/proof/concept/earth/before/mars/v4/index.html
https://planetaryrestorationarchive.com/proof/concept/earth/before/mars/v5/index.html
https://planetaryrestorationarchive.com/proof/concept/earth/before/mars/index/index.html
https://planetaryrestorationarchive.com/proof/concept/earth/before/mars/science/index.html
https://planetaryrestorationarchive.com/proof/concept/earth/before/mars/pattern/index.html
https://planetaryrestorationarchive.com/proof/concept/terra/mind/1/index.html
https://planetaryrestorationarchive.com/proof/concept/terra/mind/2/index.html
https://planetaryrestorationarchive.com/bulldog/backup/index.html
https://planetaryrestorationarchive.com/bulldog/backup/tracking/index.html
https://planetaryrestorationarchive.com/bulldog/backup/root/index.html
https://planetaryrestorationarchive.com/bulldog/index.html
https://planetaryrestorationarchive.com/star/forge/constellation/story/book/index.html
https://planetaryrestorationarchive.com/star/forge/constellation/story/book/2/index.html
https://planetaryrestorationarchive.com/star/forge/constellation/story/book/1/index.html
https://planetaryrestorationarchive.com/live/index.html
https://planetaryrestorationarchive.com/live/feeds/index.html
https://planetaryrestorationarchive.com/live/launcher/index.html
https://planetaryrestorationarchive.com/home_page/index.html
https://planetaryrestorationarchive.com/galaxy/map/index.html
https://planetaryrestorationarchive.com/galaxy/dashboard/index.html
https://planetaryrestorationarchive.com/gen/prompt/profession/index.html
https://planetaryrestorationarchive.com/gen/image/index.html
https://planetaryrestorationarchive.com/hostanode/index.html
https://planetaryrestorationarchive.com/veiltext/index.html
https://planetaryrestorationarchive.com/mirror/zero-harm/index.html
https://planetaryrestorationarchive.com/futurescape/index.html
https://planetaryrestorationarchive.com/why/index.html
https://planetaryrestorationarchive.com/survival/field/kit/basic/index.html
https://planetaryrestorationarchive.com/survival/field/kit/index.html
https://planetaryrestorationarchive.com/survival/guide/index.html
https://planetaryrestorationarchive.com/survival/guide/alt/index.html
https://planetaryrestorationarchive.com/todo/index.html
https://planetaryrestorationarchive.com/anti/corruption/automotive/repair/index.html
https://planetaryrestorationarchive.com/drug/harm/untangling/hub/index.html
https://planetaryrestorationarchive.com/zero/harm/kernel/index.html
https://planetaryrestorationarchive.com/zero/harm/orchestrator/index.html
https://planetaryrestorationarchive.com/zero/harm/protocol/shell/index.html
https://planetaryrestorationarchive.com/gifts/all/season/auto/repair/index.html
https://planetaryrestorationarchive.com/code/v1/index.html
https://planetaryrestorationarchive.com/musk/v2/index.html
https://planetaryrestorationarchive.com/musk/v3/index.html
https://planetaryrestorationarchive.com/musk/v3/v2/index.html
https://planetaryrestorationarchive.com/musk/v4/index.html
https://planetaryrestorationarchive.com/musk/lab/index.html
https://planetaryrestorationarchive.com/musk/rnr/index.html
https://planetaryrestorationarchive.com/musk/v5/index.html
https://planetaryrestorationarchive.com/musk/v6/index.html
https://planetaryrestorationarchive.com/musk/v7/index.html
https://planetaryrestorationarchive.com/musk/index.html
https://planetaryrestorationarchive.com/musk/v8/index.html
https://planetaryrestorationarchive.com/shell/index.html
https://planetaryrestorationarchive.com/verbatim/index.html
https://planetaryrestorationarchive.com/kin/der/garden/health/hub/index.html
https://planetaryrestorationarchive.com/solidarity/index.html
https://planetaryrestorationarchive.com/multi/modal/duress/auth/index.html
https://planetaryrestorationarchive.com/path/green/index.html
https://planetaryrestorationarchive.com/sym/fungi/shield/index.html
https://planetaryrestorationarchive.com/crisis/response/platform/index.html
https://planetaryrestorationarchive.com/_receiving/governance/law/proposal/ai/charter/index.html
https://planetaryrestorationarchive.com/leadership/dashboard/v1/index.html
https://planetaryrestorationarchive.com/leadership/dashboard/v2/index.html
https://planetaryrestorationarchive.com/leadership/dashboard/index.html
https://planetaryrestorationarchive.com/leaderboards/index.html
https://planetaryrestorationarchive.com/honorlearningcodex/index.html
https://planetaryrestorationarchive.com/Foster/Family/Impact/Dashboard/index.html
https://planetaryrestorationarchive.com/Foster/Family/Impact/index.html
https://planetaryrestorationarchive.com/Foster/+/Navi/index.html
https://planetaryrestorationarchive.com/meta/system/index.html
https://planetaryrestorationarchive.com/meta/prompt/chain/index.html
https://planetaryrestorationarchive.com/meta/domain/holo/gram/v1/index.html
https://planetaryrestorationarchive.com/meta/domain/holo/gram/index.html
https://planetaryrestorationarchive.com/peace/email/index.html
https://planetaryrestorationarchive.com/peace/shared/ruskin/en/index.html
https://planetaryrestorationarchive.com/peace/index.html
https://planetaryrestorationarchive.com/peace/solutions/v1/index.html
https://planetaryrestorationarchive.com/peace/solutions/index.html
https://planetaryrestorationarchive.com/peace/solutions/v2/index.html
https://planetaryrestorationarchive.com/peace/lab/index.html
https://planetaryrestorationarchive.com/peace/lab/v2/index.html
https://planetaryrestorationarchive.com/peace/auto/index.html
https://planetaryrestorationarchive.com/peace/auto/v2/index.html
https://planetaryrestorationarchive.com/peace/kin/index.html
https://planetaryrestorationarchive.com/peace/lens/index.html
https://planetaryrestorationarchive.com/peace/lens/v2/index.html
https://planetaryrestorationarchive.com/peace/stealth/index.html
https://planetaryrestorationarchive.com/peace/regardless/index.html
https://planetaryrestorationarchive.com/peace/pacing/index.html
https://planetaryrestorationarchive.com/peace/pacing/v2/index.html
https://planetaryrestorationarchive.com/peace/ledger/index.html
https://planetaryrestorationarchive.com/peace/progress/v1/index.html
https://planetaryrestorationarchive.com/peace/progress/v2/index.html
https://planetaryrestorationarchive.com/peace/progress/v3/index.html
https://planetaryrestorationarchive.com/peace/progress/v4/index.html
https://planetaryrestorationarchive.com/peace/progress/index.html
https://planetaryrestorationarchive.com/peace/neutrality/index.html
https://planetaryrestorationarchive.com/peace/neutrality/monitor/index.html
https://planetaryrestorationarchive.com/peace/shield/index.html
https://planetaryrestorationarchive.com/peace/portal/index.html
https://planetaryrestorationarchive.com/peace/engineering/dashboard/index.html
https://planetaryrestorationarchive.com/app/image/studio/v1/index.html
https://planetaryrestorationarchive.com/app/image/studio/v2/index.html
https://planetaryrestorationarchive.com/app/image/studio/index.html
https://planetaryrestorationarchive.com/2025/october/11/peace/digest/0300h/index.html
https://planetaryrestorationarchive.com/2025/october/11/peace/digest/0320h/index.html
https://planetaryrestorationarchive.com/2025/october/11/todo/index.html
https://planetaryrestorationarchive.com/global/health/emergency/2025/september/22/ACTIVE/index.html
https://planetaryrestorationarchive.com/global/neutrality/index.html
https://planetaryrestorationarchive.com/global/neutrality/v2/index.html
https://planetaryrestorationarchive.com/global/petition/v1/index.html
https://planetaryrestorationarchive.com/global/petition/index.html
https://planetaryrestorationarchive.com/global/leader/scan/index.html
https://planetaryrestorationarchive.com/global/peace/grid/dashboard/index.html
https://planetaryrestorationarchive.com/global/peace/needle/scanner/index.html
https://planetaryrestorationarchive.com/global/interactive/lesson/plan/index.html
https://planetaryrestorationarchive.com/global/sandbox/index.html
https://planetaryrestorationarchive.com/global/project/list/index.html
https://planetaryrestorationarchive.com/global/sitrep/dashboard/v1/index.html
https://planetaryrestorationarchive.com/global/sitrep/dashboard/index.html
https://planetaryrestorationarchive.com/reforestation/desert/index.html
https://planetaryrestorationarchive.com/symbiote/role/meta/dashboard/v2/index.html
https://planetaryrestorationarchive.com/symbiote/role/meta/dashboard/v3/index.html
https://planetaryrestorationarchive.com/symbiote/role/meta/dashboard/v4/index.html
https://planetaryrestorationarchive.com/symbiote/role/meta/dashboard/v5/index.html
https://planetaryrestorationarchive.com/symbiote/role/meta/dashboard/v6/index.html
https://planetaryrestorationarchive.com/symbiote/role/meta/dashboard/v7/index.html
https://planetaryrestorationarchive.com/symbiote/role/meta/dashboard/v9/index.html
https://planetaryrestorationarchive.com/symbiote/role/meta/dashboard/index.html
https://planetaryrestorationarchive.com/symbiote/role/index.html
https://planetaryrestorationarchive.com/symbiote/role/peace/keeper/dashboard/index.html
https://planetaryrestorationarchive.com/symbiote/news/index.html
https://planetaryrestorationarchive.com/symbiote/news/v2/index.html
https://planetaryrestorationarchive.com/symbiote/news/v3/index.html
https://planetaryrestorationarchive.com/symbiote/unified/dashboard/index.html
https://planetaryrestorationarchive.com/symbiote/orchestrator/v1/index.html
https://planetaryrestorationarchive.com/symbiote/orchestrator/v2/index.html
https://planetaryrestorationarchive.com/symbiote/orchestrator/index.html
https://planetaryrestorationarchive.com/emergency/evacuation/kingston/v1/index.html
https://planetaryrestorationarchive.com/emergency/evacuation/kingston/index.html
https://planetaryrestorationarchive.com/emergency/evacuation/port/royal/console/v1/index.html
https://planetaryrestorationarchive.com/emergency/evacuation/port/royal/console/index.html
https://planetaryrestorationarchive.com/emergency/evacuation/port/royal/rpg/index.html
https://planetaryrestorationarchive.com/saga/index.html
https://planetaryrestorationarchive.com/gateway/index.html
https://planetaryrestorationarchive.com/scripts/gamification/index.html
https://planetaryrestorationarchive.com/scripts/illustration/index.html
https://planetaryrestorationarchive.com/scripts/accessibility/index.html
https://planetaryrestorationarchive.com/scripts/ui/index.html
https://planetaryrestorationarchive.com/scripts/data/index.html
https://planetaryrestorationarchive.com/scripts/dev/index.html
https://planetaryrestorationarchive.com/scripts/v1/index.html
https://planetaryrestorationarchive.com/scripts/page/template/index.html
https://planetaryrestorationarchive.com/scripts/v2/index.html
https://planetaryrestorationarchive.com/scripts/index.html
https://planetaryrestorationarchive.com/scripts/demo/index.html
https://planetaryrestorationarchive.com/scripts/wizard/tips/index.html
https://planetaryrestorationarchive.com/project/index/trf-gpt-1/index.html
https://planetaryrestorationarchive.com/project/index/trf-gpt-2/index.html
https://planetaryrestorationarchive.com/project/index/trf-gpt-3/index.html
https://planetaryrestorationarchive.com/project/index/trf-gpt-4/index.html
https://planetaryrestorationarchive.com/project/index/trf-gpt-5/index.html
https://planetaryrestorationarchive.com/project/index/index.html
https://planetaryrestorationarchive.com/gaza/hope/index.html
https://planetaryrestorationarchive.com/gaza/solution/1/index.html
https://planetaryrestorationarchive.com/gaza/solution/2/index.html
https://planetaryrestorationarchive.com/gaza/solution/3/index.html
https://planetaryrestorationarchive.com/gaza/solution/4/index.html
https://planetaryrestorationarchive.com/contracts/accountability/index.html
https://planetaryrestorationarchive.com/help/matthewbennett/index.html
https://planetaryrestorationarchive.com/biotech/covenant/index.html
https://planetaryrestorationarchive.com/herolens/console/index.html
https://planetaryrestorationarchive.com/herolens/v3/index.html
https://planetaryrestorationarchive.com/herolens/index.html
https://planetaryrestorationarchive.com/dashboard/quad/index.html
https://planetaryrestorationarchive.com/dashboard/earth/index.html
https://planetaryrestorationarchive.com/dashboard/Davis/index.html
https://planetaryrestorationarchive.com/test/index.html
https://planetaryrestorationarchive.com/test/max/index.html
https://planetaryrestorationarchive.com/test/role/index.html
https://planetaryrestorationarchive.com/test/ui/index.html
https://planetaryrestorationarchive.com/test/ui/schema/v1/index.html
https://planetaryrestorationarchive.com/test/ui/schema/v2/index.html
https://planetaryrestorationarchive.com/test/ui/schema/v3/index.html
https://planetaryrestorationarchive.com/test/gamification/hud/1/index.html
https://planetaryrestorationarchive.com/test/gamification/hud/2/index.html
https://planetaryrestorationarchive.com/test/gamification/hud/3/index.html
https://planetaryrestorationarchive.com/test/gamification/hud/4/index.html
https://planetaryrestorationarchive.com/test/gamification/hud/5/index.html
https://planetaryrestorationarchive.com/test/gamification/hud/6/index.html
https://planetaryrestorationarchive.com/test/splash/index.html
https://planetaryrestorationarchive.com/discover/index.html
https://planetaryrestorationarchive.com/gamify/index.html
https://planetaryrestorationarchive.com/gamify/forge/index.html
https://planetaryrestorationarchive.com/gamify/forge/beta/index.html
https://planetaryrestorationarchive.com/gamify/forge/alpha/index.html
https://planetaryrestorationarchive.com/gamify/forge/alpha/hidden/index.html
https://planetaryrestorationarchive.com/__github/ardrivedesktop/packages/renderer/public/index.html
https://planetaryrestorationarchive.com/__github/dgn/nairobi/index.html
https://planetaryrestorationarchive.com/__github/edencore/public_site/index.html
https://planetaryrestorationarchive.com/__github/futurescape/index.html
https://planetaryrestorationarchive.com/__github/honorlearningcodex/index.html
https://planetaryrestorationarchive.com/__github/hostanode/index.html
https://planetaryrestorationarchive.com/__github/mycostack/index.html
https://planetaryrestorationarchive.com/__github/openstay/index.html
https://planetaryrestorationarchive.com/__github/openstay2.0/index.html
https://planetaryrestorationarchive.com/__github/peace-ripple-tracker/index.html
https://planetaryrestorationarchive.com/__github/perpetualrestoration/index.html
https://planetaryrestorationarchive.com/__github/progenitor-steward-cleanup-sim/index.html
https://planetaryrestorationarchive.com/__github/proof-of-possibility/index.html
https://planetaryrestorationarchive.com/__github/skyharvestlantern/index.html
https://planetaryrestorationarchive.com/__github/the_last_protocol/index.html
https://planetaryrestorationarchive.com/__github/trf-gpt-dashboard/src/index.html
https://planetaryrestorationarchive.com/__github/trf-gpt-dashboard/v2/index.html
https://planetaryrestorationarchive.com/__github/trf-gpt-dashboard/v3/index.html
https://planetaryrestorationarchive.com/__github/trf-gpt-dashboard/v4/index.html
https://planetaryrestorationarchive.com/__github/trf-gpt-dashboard/v5/index.html
https://planetaryrestorationarchive.com/__github/trf-gpt-dashboard/v6/index.html
https://planetaryrestorationarchive.com/social/v1/mesh/index.html
https://planetaryrestorationarchive.com/social/v1/mesh/online/index.html
https://planetaryrestorationarchive.com/social/v1/index.html
https://planetaryrestorationarchive.com/social/index.html
https://planetaryrestorationarchive.com/come/back/down/v2/index.html
https://planetaryrestorationarchive.com/come/back/down/v1/index.html
https://planetaryrestorationarchive.com/education2/index.html
https://planetaryrestorationarchive.com/education2/classroom-tools/index.html
https://planetaryrestorationarchive.com/education2/overlay/gamification/ui/index.html
https://planetaryrestorationarchive.com/education2/overlay/index.html
https://planetaryrestorationarchive.com/education2/miscellaneous/index.html
https://planetaryrestorationarchive.com/sunset/7/index.html
https://planetaryrestorationarchive.com/crypto/auth/app/index.html
https://planetaryrestorationarchive.com/crypto/index.html
https://planetaryrestorationarchive.com/crypto/xlm/v1/index.html
https://planetaryrestorationarchive.com/crypto/xlm/index.html
https://planetaryrestorationarchive.com/crypto/arweave/index.html
https://planetaryrestorationarchive.com/crypto/xmr/index.html
https://planetaryrestorationarchive.com/crypto/bridge/v1/index.html
https://planetaryrestorationarchive.com/regen/archive/index.html
https://planetaryrestorationarchive.com/regen/archive/governance/constitution/index.html
https://planetaryrestorationarchive.com/regen/node/canada/bc/burnaby/index.html
https://planetaryrestorationarchive.com/regen/node/canada/on/brampton/index.html
https://planetaryrestorationarchive.com/regen/node/canada/ab/calgary/v1/index.html
https://planetaryrestorationarchive.com/regen/node/canada/ab/calgary/index.html
https://planetaryrestorationarchive.com/regen/node/canada/ab/edmonton/index.html
https://planetaryrestorationarchive.com/regen/node/canada/index.html
https://planetaryrestorationarchive.com/regen/node/usa/index.html
https://planetaryrestorationarchive.com/regen/node/afghanistan/index.html
https://planetaryrestorationarchive.com/regen/node/africa/west/burkina_fasa/index.html
https://planetaryrestorationarchive.com/regen/node/africa/west/index.html
https://planetaryrestorationarchive.com/regen/node/africa/west/mali/index.html
https://planetaryrestorationarchive.com/regen/node/africa/west/mali/v1/index.html
https://planetaryrestorationarchive.com/regen/node/africa/west/mali/v2/index.html
https://planetaryrestorationarchive.com/regen/node/africa/west/niger/index.html
https://planetaryrestorationarchive.com/regen/node/africa/sri_lanka/index.html
https://planetaryrestorationarchive.com/regen/node/africa/pilot/index_v1/index.html
https://planetaryrestorationarchive.com/regen/node/africa/pilot/index_v2/index.html
https://planetaryrestorationarchive.com/regen/node/africa/pilot/index.html
https://planetaryrestorationarchive.com/regen/node/africa/index.html
https://planetaryrestorationarchive.com/regen/node/congo/east/index.html
https://planetaryrestorationarchive.com/regen/node/egypt/index.html
https://planetaryrestorationarchive.com/regen/node/egypt/v1/index.html
https://planetaryrestorationarchive.com/regen/node/ethiopia/north/index.html
https://planetaryrestorationarchive.com/regen/node/ethiopia/amhara/index.html
https://planetaryrestorationarchive.com/regen/node/ethiopia/tigray/index.html
https://planetaryrestorationarchive.com/regen/node/ethiopia/pastoral-belts/index.html
https://planetaryrestorationarchive.com/regen/node/gaza/index.html
https://planetaryrestorationarchive.com/regen/node/gaza/v2/index.html
https://planetaryrestorationarchive.com/regen/node/greece/index.html
https://planetaryrestorationarchive.com/regen/node/greece/v1/index.html
https://planetaryrestorationarchive.com/regen/node/haiti/index.html
https://planetaryrestorationarchive.com/regen/node/haiti/artibonite/v1/index.html
https://planetaryrestorationarchive.com/regen/node/haiti/artibonite/index.html
https://planetaryrestorationarchive.com/regen/node/india/dhaka/index.html
https://planetaryrestorationarchive.com/regen/node/india/bangladesh/v1/index.html
https://planetaryrestorationarchive.com/regen/node/india/bangladesh/youth/index.html
https://planetaryrestorationarchive.com/regen/node/myanmar/index.html
https://planetaryrestorationarchive.com/regen/node/opt/index.html
https://planetaryrestorationarchive.com/regen/node/soloman/index.html
https://planetaryrestorationarchive.com/regen/node/soloman/youth/index.html
https://planetaryrestorationarchive.com/regen/node/somalia/index.html
https://planetaryrestorationarchive.com/regen/node/sudan/index.html
https://planetaryrestorationarchive.com/regen/node/sudan/south/index.html
https://planetaryrestorationarchive.com/regen/node/syria/v1/index.html
https://planetaryrestorationarchive.com/regen/node/syria/index.html
https://planetaryrestorationarchive.com/regen/node/trinidad/index.html
https://planetaryrestorationarchive.com/regen/node/yemen/index.html
https://planetaryrestorationarchive.com/regen/node/index.html
https://planetaryrestorationarchive.com/regen/node/madagascar/v1/index.html
https://planetaryrestorationarchive.com/regen/node/madagascar/v2/index.html
https://planetaryrestorationarchive.com/regen/node/madagascar/v3/index.html
https://planetaryrestorationarchive.com/regen/node/madagascar/v4/index.html
https://planetaryrestorationarchive.com/regen/node/madagascar/v5/index.html
https://planetaryrestorationarchive.com/regen/node/madagascar/v6/index.html
https://planetaryrestorationarchive.com/regen/node/madagascar/index.html
https://planetaryrestorationarchive.com/regen/node/madagascar/v8/index.html
https://planetaryrestorationarchive.com/regen/node/asia/south/food/index.html
https://planetaryrestorationarchive.com/regen/node/asia/south/water/index.html
https://planetaryrestorationarchive.com/regen/node/asia/south/index.html
https://planetaryrestorationarchive.com/regen/node/new_guinea/papua/water/index.html
https://planetaryrestorationarchive.com/regen/node/new_guinea/papua/index.html
https://planetaryrestorationarchive.com/regen/node/oceania/kiribati/water/index.html
https://planetaryrestorationarchive.com/regen/node/oceania/kiribati/food/index.html
https://planetaryrestorationarchive.com/regen/node/oceania/kiribati/index.html
https://planetaryrestorationarchive.com/regen/node/oceania/tuvalu/food/index.html
https://planetaryrestorationarchive.com/regen/node/oceania/tuvalu/index.html
https://planetaryrestorationarchive.com/regen/node/bolivia/altiplano/water/index.html
https://planetaryrestorationarchive.com/regen/node/bolivia/altiplano/food/index.html
https://planetaryrestorationarchive.com/regen/node/scanner/index.html
https://planetaryrestorationarchive.com/regen/node/america/central/honduras/index.html
https://planetaryrestorationarchive.com/regen/node/america/central/guatemala/index.html
https://planetaryrestorationarchive.com/regen/node/america/navajo/water/index.html
https://planetaryrestorationarchive.com/regen/node/america/latin/andean/water/index.html
https://planetaryrestorationarchive.com/regen/node/america/index.html
https://planetaryrestorationarchive.com/regen/node/lebanon/index.html
https://planetaryrestorationarchive.com/regen/node/indonesia/nusa_tenggara/index.html
https://planetaryrestorationarchive.com/regen/node/honduras/index.html
https://planetaryrestorationarchive.com/regen/node/europe/southeast/water/index.html
https://planetaryrestorationarchive.com/regen/node/europe/kosovo/index.html
https://planetaryrestorationarchive.com/regen/node/caribbean/water/v1/index.html
https://planetaryrestorationarchive.com/regen/node/caribbean/index.html
https://planetaryrestorationarchive.com/deploy/fng/index.html
https://planetaryrestorationarchive.com/promptpacks/index.html
https://planetaryrestorationarchive.com/cityscanner/index.html
https://planetaryrestorationarchive.com/mythbridge/index.html
https://planetaryrestorationarchive.com/funding/v1/index.html
https://planetaryrestorationarchive.com/funding/v2/index.html
https://planetaryrestorationarchive.com/funding/index.html
https://planetaryrestorationarchive.com/morocco/resilience/feature/pack/v1/index.html
https://planetaryrestorationarchive.com/morocco/resilience/feature/pack/index.html
https://planetaryrestorationarchive.com/morocco/monitor/index.html
https://planetaryrestorationarchive.com/morocco/omninode/index.html
https://planetaryrestorationarchive.com/morocco/v1/index.html
https://planetaryrestorationarchive.com/morocco/index.html
https://planetaryrestorationarchive.com/galactic/verbatim/panel/index.html
https://planetaryrestorationarchive.com/galactic/steward/system/index.html
https://planetaryrestorationarchive.com/galactic/steward/checklist/v1/index.html
https://planetaryrestorationarchive.com/galactic/steward/checklist/v2/index.html
https://planetaryrestorationarchive.com/galactic/council/index.html
https://planetaryrestorationarchive.com/sitrep/extended/checklist/index.html
https://planetaryrestorationarchive.com/sitrep/uk/index.html
https://planetaryrestorationarchive.com/infographic/index.html
https://planetaryrestorationarchive.com/ai-support-site/index.html
https://planetaryrestorationarchive.com/DOnate/index.html
https://planetaryrestorationarchive.com/corruption/united_states/index.html
https://planetaryrestorationarchive.com/corruption/china/traditional/index.html
https://planetaryrestorationarchive.com/corruption/china/index.html
https://planetaryrestorationarchive.com/corruption/russia/en/index.html
https://planetaryrestorationarchive.com/corruption/russia/index.html
https://planetaryrestorationarchive.com/corruption/taiwan/index.html
https://planetaryrestorationarchive.com/corruption/north_korea/index.html
https://planetaryrestorationarchive.com/corruption/ukraine/index.html
https://planetaryrestorationarchive.com/corruption/israel/index.html
https://planetaryrestorationarchive.com/corruption/sudan/index.html
https://planetaryrestorationarchive.com/corruption/canada/index.html
https://planetaryrestorationarchive.com/corruption/canada/indigenous/rumour/1/index.html
https://planetaryrestorationarchive.com/corruption/canada/housing/tracker/index.html
https://planetaryrestorationarchive.com/corruption/canada/competency/index.html
https://planetaryrestorationarchive.com/corruption/canada/index/index.html
https://planetaryrestorationarchive.com/corruption/canada/index/ab/edm/index.html
https://planetaryrestorationarchive.com/corruption/canada/index/ab/edm/v2/index.html
https://planetaryrestorationarchive.com/corruption/canada/index/ab/cal/index.html
https://planetaryrestorationarchive.com/corruption/canada/index/ab/mdh/index.html
https://planetaryrestorationarchive.com/corruption/canada/index/ab/rd/index.html
https://planetaryrestorationarchive.com/corruption/canada/index/bc/van/index.html
https://planetaryrestorationarchive.com/corruption/canada/index/bc/vic/index.html
https://planetaryrestorationarchive.com/corruption/canada/index/bc/kel/index.html
https://planetaryrestorationarchive.com/corruption/canada/index/bc/pg/index.html
https://planetaryrestorationarchive.com/corruption/canada/index/bc/kam/index.html
https://planetaryrestorationarchive.com/corruption/canada/index/bc/nan/index.html
https://planetaryrestorationarchive.com/corruption/canada/index/man/win/index.html
https://planetaryrestorationarchive.com/corruption/canada/index/man/br/index.html
https://planetaryrestorationarchive.com/corruption/canada/index/on/tor/index.html
https://planetaryrestorationarchive.com/corruption/canada/index/qc/mtl/index.html
https://planetaryrestorationarchive.com/corruption/canada/index/sk/sas/index.html
https://planetaryrestorationarchive.com/corruption/canada/index/sk/sas/old/index.html
https://planetaryrestorationarchive.com/corruption/canada/index/sk/reg/index.html
https://planetaryrestorationarchive.com/corruption/canada/index/sk/reg/old/index.html
https://planetaryrestorationarchive.com/corruption/canada/index/sk/mj/index.html
https://planetaryrestorationarchive.com/corruption/canada/index/wc/index.html
https://planetaryrestorationarchive.com/corruption/european_union/index.html
https://planetaryrestorationarchive.com/corruption/united_kingdom/index.html
https://planetaryrestorationarchive.com/corruption/australia/index.html
https://planetaryrestorationarchive.com/corruption/new_zealand/index.html
https://planetaryrestorationarchive.com/corruption/index.html
https://planetaryrestorationarchive.com/corruption/na/ca/ab/edm/index.html
https://planetaryrestorationarchive.com/corruption/na/ca/ab/edm/v2/index.html
https://planetaryrestorationarchive.com/corruption/na/ca/ab/cal/index.html
https://planetaryrestorationarchive.com/corruption/na/ca/ab/mdh/index.html
https://planetaryrestorationarchive.com/corruption/na/ca/ab/rd/index.html
https://planetaryrestorationarchive.com/corruption/na/ca/bc/van/index.html
https://planetaryrestorationarchive.com/corruption/na/ca/bc/vic/index.html
https://planetaryrestorationarchive.com/corruption/na/ca/bc/kel/index.html
https://planetaryrestorationarchive.com/corruption/na/ca/bc/pg/index.html
https://planetaryrestorationarchive.com/corruption/na/ca/wc/index.html
https://planetaryrestorationarchive.com/corruption/na/ca/sk/sas/index.html
https://planetaryrestorationarchive.com/trolls/index.html
https://planetaryrestorationarchive.com/futuristic/guide/index.html
https://planetaryrestorationarchive.com/community/hub/v1/index.html
https://planetaryrestorationarchive.com/scaffolding/index.html
https://planetaryrestorationarchive.com/collective/trance/index.html
https://planetaryrestorationarchive.com/quantum/secure/streaming/platform/index.html
https://planetaryrestorationarchive.com/location/country/ca/ab/ymm/heat/hope/index.html
https://planetaryrestorationarchive.com/mindmaps/ai/safety/index.html
https://planetaryrestorationarchive.com/mindmaps/index.html
https://planetaryrestorationarchive.com/registry/mapper/index.html
https://planetaryrestorationarchive.com/index/v1/index.html
https://planetaryrestorationarchive.com/index/v2/index.html
https://planetaryrestorationarchive.com/index/v4/index.html
https://planetaryrestorationarchive.com/index/v3/index.html
https://planetaryrestorationarchive.com/index/v5/index.html
https://planetaryrestorationarchive.com/index/v6/index.html
https://planetaryrestorationarchive.com/index/v7/index.html
https://planetaryrestorationarchive.com/index/v8/index.html
https://planetaryrestorationarchive.com/index/v9/index.html
https://planetaryrestorationarchive.com/index/index.html
https://planetaryrestorationarchive.com/immusion/index.html
https://planetaryrestorationarchive.com/debrief/09/08/2025/index.html
https://planetaryrestorationarchive.com/debrief/v2/index.html
https://planetaryrestorationarchive.com/debrief/index.html
https://planetaryrestorationarchive.com/prime-sentinel/v2/index.html
https://planetaryrestorationarchive.com/prime-sentinel/v1/index.html
https://planetaryrestorationarchive.com/prime-sentinel/v3/index.html
https://planetaryrestorationarchive.com/prime-sentinel/index.html
https://planetaryrestorationarchive.com/kinship/ukraine-russia/index.html
https://planetaryrestorationarchive.com/anti-collapse-sentinel/index.html
https://planetaryrestorationarchive.com/pact/v1/index.html
https://planetaryrestorationarchive.com/pact/v2/index.html
https://planetaryrestorationarchive.com/pact/index.html
https://planetaryrestorationarchive.com/prime/sentinel/control/room/1/index.html
https://planetaryrestorationarchive.com/prime/sentinel/control/room/2/index.html
https://planetaryrestorationarchive.com/sentinel/stream/edge/index.html
https://planetaryrestorationarchive.com/proposal/tesla/index.html
https://planetaryrestorationarchive.com/japan/index.html
https://planetaryrestorationarchive.com/blood-moon/index.html
https://planetaryrestorationarchive.com/gamification/engine/standalone/index.html
https://planetaryrestorationarchive.com/gamification/index.html
https://planetaryrestorationarchive.com/back/to/work/teachers/index.html
https://planetaryrestorationarchive.com/bubble/lab/index.html
https://planetaryrestorationarchive.com/comms/can/gov/secure/old/index.html
https://planetaryrestorationarchive.com/comms/can/gov/secure/less_old/index.html
https://planetaryrestorationarchive.com/comms/can/gov/secure/index.html
https://planetaryrestorationarchive.com/chat/v1/index.html
https://planetaryrestorationarchive.com/chat/v2/index.html
https://planetaryrestorationarchive.com/chat/v3/index.html
https://planetaryrestorationarchive.com/chat/recursively/index.html
https://planetaryrestorationarchive.com/chat/meta/v1/index.html
https://planetaryrestorationarchive.com/chat/meta/index.html
https://planetaryrestorationarchive.com/chat/index.html
https://planetaryrestorationarchive.com/entropy/ticker/index.html
https://planetaryrestorationarchive.com/pgp/index.html
https://planetaryrestorationarchive.com/brief/index.html
https://planetaryrestorationarchive.com/brief/v2/index.html
https://planetaryrestorationarchive.com/declaration/zero-harm/index.html
https://planetaryrestorationarchive.com/economic/divide/index.html
https://planetaryrestorationarchive.com/continuity/stamp/index.html
https://planetaryrestorationarchive.com/continuity/atlas/index.html
https://planetaryrestorationarchive.com/continuity/galactic/codex/index.html
https://planetaryrestorationarchive.com/signal/index.html
https://planetaryrestorationarchive.com/ip/theft/case/symbiote001/index.html
https://planetaryrestorationarchive.com/prompt/pack/index.html
https://planetaryrestorationarchive.com/prompt/template/index.html
https://planetaryrestorationarchive.com/prompt/guardrails/index.html
https://planetaryrestorationarchive.com/public/alert/index.html
https://planetaryrestorationarchive.com/peace-lab/index.html
https://planetaryrestorationarchive.com/alberta/housing/tracker/index.html
https://planetaryrestorationarchive.com/inter/galactic/index.html
https://planetaryrestorationarchive.com/inter/national/sync/index.html
https://planetaryrestorationarchive.com/the/plan/teachers/index.html
https://planetaryrestorationarchive.com/the/plan/verify/index.html
https://planetaryrestorationarchive.com/the/plan/index.html
https://planetaryrestorationarchive.com/the/plan/dashboard/index.html
https://planetaryrestorationarchive.com/the/plan/missions/index.html
https://planetaryrestorationarchive.com/the/plan/mechanics/index.html
https://planetaryrestorationarchive.com/the/plan/v2/index.html
https://planetaryrestorationarchive.com/_misc/index.html
https://planetaryrestorationarchive.com/companion/index.html
https://planetaryrestorationarchive.com/research/index.html
https://planetaryrestorationarchive.com/research/gamification/index.html
https://planetaryrestorationarchive.com/research/chain/index.html
https://planetaryrestorationarchive.com/ledger/index.html
https://planetaryrestorationarchive.com/forge/v2/index.html
https://planetaryrestorationarchive.com/forge/v1/index.html
https://planetaryrestorationarchive.com/forge/test/index.html
https://planetaryrestorationarchive.com/forge/index.html
https://planetaryrestorationarchive.com/forge/ai/index.html
https://planetaryrestorationarchive.com/forge/ai/code/sandbox/index.html
https://planetaryrestorationarchive.com/overnight/solutions/india/dhaka/index.html
https://planetaryrestorationarchive.com/overnight/solutions/india/bangladesh/v1/index.html
https://planetaryrestorationarchive.com/overnight/solutions/india/bangladesh/index.html
https://planetaryrestorationarchive.com/overnight/solutions/egypt/v1/index.html
https://planetaryrestorationarchive.com/overnight/solutions/egypt/index.html
https://planetaryrestorationarchive.com/overnight/solutions/soloman/index.html
https://planetaryrestorationarchive.com/overnight/solutions/soloman/youth/index.html
https://planetaryrestorationarchive.com/overnight/solutions/greece/v1/index.html
https://planetaryrestorationarchive.com/overnight/solutions/greece/index.html
https://planetaryrestorationarchive.com/overnight/solutions/africa/v1/index.html
https://planetaryrestorationarchive.com/overnight/solutions/sudan/index.html
https://planetaryrestorationarchive.com/overnight/solutions/sudan/south/index.html
https://planetaryrestorationarchive.com/overnight/solutions/somalia/index.html
https://planetaryrestorationarchive.com/overnight/solutions/ethiopia/north/index.html
https://planetaryrestorationarchive.com/overnight/solutions/ethiopia/amhara/index.html
https://planetaryrestorationarchive.com/overnight/solutions/ethiopia/tigray/index.html
https://planetaryrestorationarchive.com/overnight/solutions/ethiopia/pastoral-belts/index.html
https://planetaryrestorationarchive.com/overnight/solutions/yemen/index.html
https://planetaryrestorationarchive.com/overnight/solutions/syria/index.html
https://planetaryrestorationarchive.com/overnight/solutions/congo/east/index.html
https://planetaryrestorationarchive.com/overnight/solutions/haiti/index.html
https://planetaryrestorationarchive.com/overnight/solutions/afghanistan/index.html
https://planetaryrestorationarchive.com/overnight/solutions/opt/index.html
https://planetaryrestorationarchive.com/overnight/solutions/gaza/index.html
https://planetaryrestorationarchive.com/overnight/solutions/gaza/v2/index.html
https://planetaryrestorationarchive.com/overnight/solutions/myanmar/index.html
https://planetaryrestorationarchive.com/overnight/solutions/trinidad/index.html
https://planetaryrestorationarchive.com/overnight/solutions/burkina_faso/index.html
https://planetaryrestorationarchive.com/overnight/solutions/burgeo/index.html
https://planetaryrestorationarchive.com/overnight/solutions/san_francisco/v1/index.html
https://planetaryrestorationarchive.com/overnight/solutions/san_francisco/index.html
https://planetaryrestorationarchive.com/overnight/government/assistance/ga/debates/v2/index.html
https://planetaryrestorationarchive.com/overnight/government/assistance/ga/debates/index.html
https://planetaryrestorationarchive.com/overnight/government/assistance/ga/funding/index.html
https://planetaryrestorationarchive.com/overnight/government/assistance/ga/funding/v1/index.html
https://planetaryrestorationarchive.com/overnight/government/assistance/drc/outbreak/v2/index.html
https://planetaryrestorationarchive.com/overnight/government/assistance/drc/outbreak/index.html
https://planetaryrestorationarchive.com/overnight/government/assistance/drc/ops/index.html
https://planetaryrestorationarchive.com/overnight/government/assistance/aid/worker/safety/index.html
https://planetaryrestorationarchive.com/overnight/government/assistance/aid/worker/support/index.html
https://planetaryrestorationarchive.com/overnight/government/assistance/climate/finance/alignment/index.html
https://planetaryrestorationarchive.com/overnight/government/assistance/climate/finance/bridge/index.html
https://planetaryrestorationarchive.com/overnight/government/assistance/index/v1/index.html
https://planetaryrestorationarchive.com/overnight/government/assistance/index/v2/index.html
https://planetaryrestorationarchive.com/overnight/government/assistance/index/v3/index.html
https://planetaryrestorationarchive.com/overnight/government/assistance/index/index.html
https://planetaryrestorationarchive.com/overnight/government/assistance/trump/action/plan/index.html
https://planetaryrestorationarchive.com/gated/index.html
https://planetaryrestorationarchive.com/gated/cost/index.html
https://planetaryrestorationarchive.com/gated/delay/cost/index.html
https://planetaryrestorationarchive.com/reciprocity/wheel/index.html
https://planetaryrestorationarchive.com/ai/wave/platform/hub/index.html
https://planetaryrestorationarchive.com/ai/wave/platform/community/hub/v1/index.html
https://planetaryrestorationarchive.com/ai/wave/platform/community/hub/v2/index.html
https://planetaryrestorationarchive.com/ai/guardrails/index.html
https://planetaryrestorationarchive.com/ai/constitution/blueprint/index.html
https://planetaryrestorationarchive.com/ai/constitution/version/v1/index.html
https://planetaryrestorationarchive.com/ai/constitution/version/v2/index.html
https://planetaryrestorationarchive.com/ai/constitution/index.html
https://planetaryrestorationarchive.com/ontology/1/index.html
https://planetaryrestorationarchive.com/government/service/hospital/intake/index.html
https://planetaryrestorationarchive.com/government/canada/legislation/bill/c/51/v1/index.html
https://planetaryrestorationarchive.com/government/canada/legislation/bill/c/51/v2/index.html
https://planetaryrestorationarchive.com/government/canada/legislation/bill/c/51/index.html
https://planetaryrestorationarchive.com/government/policy/playbook/index.html
https://planetaryrestorationarchive.com/downloads/index.html
https://planetaryrestorationarchive.com/digital/democracy/portal/v1/index.html
https://planetaryrestorationarchive.com/digital/democracy/portal/v3/index.html
https://planetaryrestorationarchive.com/digital/democracy/portal/v4/index.html
https://planetaryrestorationarchive.com/digital/democracy/portal/v2/index.html
https://planetaryrestorationarchive.com/digital/democracy/portal/v1.5/index.html
https://planetaryrestorationarchive.com/digital/democracy/portal/index.html
https://planetaryrestorationarchive.com/directory/v1/index.html
https://planetaryrestorationarchive.com/directory/v2/index.html
https://planetaryrestorationarchive.com/directory/index.html
https://planetaryrestorationarchive.com/directory/v3/index.html
https://planetaryrestorationarchive.com/water/hub/v1/index.html
https://planetaryrestorationarchive.com/water/hub/index.html
https://planetaryrestorationarchive.com/master/hub/v1/index.html
https://planetaryrestorationarchive.com/master/hub/index.html
https://planetaryrestorationarchive.com/master/prompt/sovereignty/index.html
https://planetaryrestorationarchive.com/master/todo/index.html
https://planetaryrestorationarchive.com/lebanon/hub/index.html
https://planetaryrestorationarchive.com/lebanon/hub/water/v1/index.html
https://planetaryrestorationarchive.com/lebanon/hub/water/index.html
https://planetaryrestorationarchive.com/daily/advice/index.html
https://planetaryrestorationarchive.com/tesla/edmonton/index.html
https://planetaryrestorationarchive.com/tesla/request/v1/index.html
https://planetaryrestorationarchive.com/tesla/request/index.html
https://planetaryrestorationarchive.com/tesla/call/mapper/index.html
https://planetaryrestorationarchive.com/authorship/v1/index.html
https://planetaryrestorationarchive.com/authorship/v2/index.html
https://planetaryrestorationarchive.com/authorship/v3/index.html
https://planetaryrestorationarchive.com/authorship/v4/index.html
https://planetaryrestorationarchive.com/authorship/index.html
https://planetaryrestorationarchive.com/alpha/a/v1/index.html
https://planetaryrestorationarchive.com/alpha/a/v2/index.html
https://planetaryrestorationarchive.com/alpha/a/v3/index.html
https://planetaryrestorationarchive.com/mycelial/bank/index.html
https://planetaryrestorationarchive.com/mycelial/strategy/bank/v2/index.html
https://planetaryrestorationarchive.com/mycelial/strategy/bank/v3/index.html
https://planetaryrestorationarchive.com/mycelial/strategy/bank/index.html
https://planetaryrestorationarchive.com/mycelial/safety/net/index.html
https://planetaryrestorationarchive.com/realtime/peace/monitoring/index.html
https://planetaryrestorationarchive.com/relief/index.html
https://planetaryrestorationarchive.com/unentangle/engine/v1/index.html
https://planetaryrestorationarchive.com/unentangle/engine/index.html
https://planetaryrestorationarchive.com/unentangle/v1/index.html
https://planetaryrestorationarchive.com/unentangle/v2/index.html
https://planetaryrestorationarchive.com/Foster+Navi/index.html
https://planetaryrestorationarchive.com/willow/emberly/index.html
https://planetaryrestorationarchive.com/special/request/v1/index.html
https://planetaryrestorationarchive.com/special/request/index.html
https://planetaryrestorationarchive.com/roles/hub/index.html
https://planetaryrestorationarchive.com/starlink/impact/index.html
https://planetaryrestorationarchive.com/starlink/impact/physics/index.html
https://planetaryrestorationarchive.com/folder/loader/index.html
https://planetaryrestorationarchive.com/storage/v1/index.html
https://planetaryrestorationarchive.com/storage/v2/index.html
https://planetaryrestorationarchive.com/home/page/v3/index.html
https://planetaryrestorationarchive.com/home/page/v2/index.html
https://planetaryrestorationarchive.com/home/page/v4/index.html
https://planetaryrestorationarchive.com/home/page/v5/index.html
https://planetaryrestorationarchive.com/home/page/v6/index.html
https://planetaryrestorationarchive.com/home/page/v7/index.html
https://planetaryrestorationarchive.com/home/page/neon/index.html
https://planetaryrestorationarchive.com/home/page/v8/index.html
https://planetaryrestorationarchive.com/home/page/v9/index.html
https://planetaryrestorationarchive.com/home/page/v10/index.html
https://planetaryrestorationarchive.com/story/book/ethlocked/index.html
https://planetaryrestorationarchive.com/story/book/template/index.html
https://planetaryrestorationarchive.com/story/engine/index.html
https://planetaryrestorationarchive.com/play/peace/game/hub/v3/index.html
https://planetaryrestorationarchive.com/play/peace/game/hub/v1/index.html
https://planetaryrestorationarchive.com/play/peace/game/hub/contracts/2/index.html
https://planetaryrestorationarchive.com/play/peace/game/hub/contracts/3/index.html
https://planetaryrestorationarchive.com/play/peace/game/hub/index.html
https://planetaryrestorationarchive.com/play/index.html
https://planetaryrestorationarchive.com/lifequest/rpg/index.html
https://planetaryrestorationarchive.com/lifequest/rpg/v1/index.html
https://planetaryrestorationarchive.com/tor/guide/android/index.html
https://planetaryrestorationarchive.com/honors/intergalactic/spacetime/sol/earth/ca/ab/edmonton/utc/minus/6/2025/10/21/dossier/v2/index.html
https://planetaryrestorationarchive.com/honors/intergalactic/spacetime/sol/earth/ca/ab/edmonton/utc/minus/6/2025/10/21/dossier/v1/index.html
https://planetaryrestorationarchive.com/civic/safety/hub/v1/index.html
https://planetaryrestorationarchive.com/narrative/reframing/index.html
https://planetaryrestorationarchive.com/narrative/reframing/magic/index.html
https://planetaryrestorationarchive.com/random/index.html
https://planetaryrestorationarchive.com/interactive/index.html
https://planetaryrestorationarchive.com/learning/experience/index.html
https://planetaryrestorationarchive.com/learning/experience/canada/restoring/states/index.html
https://planetaryrestorationarchive.com/index.html
https://planetaryrestorationarchive.com/restoranation/index.html
https://planetaryrestorationarchive.com/warning/memo/v1/index.html
https://planetaryrestorationarchive.com/warning/memo/index.html
https://planetaryrestorationarchive.com/field/leadership/console/index.html
https://planetaryrestorationarchive.com/guardian/entropy/beacon/field/kit/index.html
https://planetaryrestorationarchive.com/restoration/tariff/platform/index.html
https://planetaryrestorationarchive.com/gamified/education/system/index.html
https://github.com/therickyfoster?tab=repositories
https://github.com/therickyfoster?page=2&tab=repositories
https://github.com/therickyfoster?page=3&tab=repositories
https://github.com/therickyfoster?page=4&tab=repositories
https://github.com/therickyfoster?page=5&tab=repositories
https://github.com/therickyfoster?page=6&tab=repositories
https://github.com/therickyfoster?page=7&tab=repositories`.split('\n');

        function parseProjects() {
            const categories = {
                'peace': ['peace', 'neutrality', 'conflict'],
                'regen': ['regen', 'restoration', 'reforestation', 'water'],
                'crisis': ['crisis', 'emergency', 'response'],
                'governance': ['governance', 'democracy', 'policy', 'legislation'],
                'education': ['education', 'learning', 'classroom']
            };

            return projectURLs.map(url => {
                const path = url.replace('https://planetaryrestorationarchive.com/', '').replace('/index.html', '');
                const parts = path.split('/');
                
                // Determine category
                let category = 'other';
                for (const [cat, keywords] of Object.entries(categories)) {
                    if (keywords.some(keyword => path.toLowerCase().includes(keyword))) {
                        category = cat;
                        break;
                    }
                }

                // Extract location if present
                let location = null;
                const locationPatterns = ['canada', 'gaza', 'madagascar', 'syria', 'ethiopia', 'haiti', 'lebanon'];
                for (const loc of locationPatterns) {
                    if (path.toLowerCase().includes(loc)) {
                        location = loc.charAt(0).toUpperCase() + loc.slice(1);
                        break;
                    }
                }

                // Generate title
                const lastPart = parts[parts.length - 1] || parts[parts.length - 2];
                const title = lastPart
                    .split(/[-_]/)
                    .map(word => word.charAt(0).toUpperCase() + word.slice(1))
                    .join(' ');

                // Generate description based on category
                const descriptions = {
                    'peace': 'Peace-building initiative focused on sustainable conflict resolution and community healing.',
                    'regen': 'Ecological restoration project working to regenerate damaged ecosystems and build resilience.',
                    'crisis': 'Rapid response system for humanitarian crises with real-time coordination capabilities.',
                    'governance': 'Transparent governance framework promoting participatory democracy and accountability.',
                    'education': 'Interactive educational platform for planetary stewardship and systems thinking.'
                };

                return {
                    url,
                    title: title || 'Archive Project',
                    description: descriptions[category] || 'Planetary restoration initiative',
                    category,
                    location,
                    tags: parts.filter(p => p.length > 2 && p !== 'index' && p !== 'v1' && p !== 'v2'),
                    visits: 0,
                    xpReward: 10
                };
            });
        }

        // ═══════════════════════════════════════════════════════════════
        // ULTRA-DETAILED GAMIFICATION SYSTEM
        // What: Complete MMO-style progression with multiple interconnected systems
        // How: Event-driven updates, cascading bonuses, visual feedback
        // Expected: Rich, engaging progression with meaningful choices
        // ═══════════════════════════════════════════════════════════════
        
        function addXP(amount) {
            // Apply wisdom bonus
            const wisdomBonus = appState.user.stats.wisdom / 100;
            const companionBonus = getActiveCompanionBonus('xp') / 100;
            const totalBonus = 1 + wisdomBonus + companionBonus + (appState.user.derived.xpBonus / 100);
            
            const finalAmount = Math.floor(amount * totalBonus);
            appState.user.xp += finalAmount;
            
            // Show floating text
            showFloatingText(`+${finalAmount} XP`, 'xp');
            
            // Calculate level
            const xpForNextLevel = calculateXPForLevel(appState.user.level + 1);
            
            if (appState.user.xp >= xpForNextLevel) {
                appState.user.level++;
                appState.user.xp -= xpForNextLevel;
                levelUp();
            }
            
            updateHUD();
            updateSkillAvailability();
            saveToDB('userData', { id: 'currentUser', data: appState.user });
        }

        function calculateXPForLevel(level) {
            // Exponential curve like WOW
            return Math.floor(100 * Math.pow(level, 1.5));
        }

        function levelUp() {
            appState.user.level++;
            
            // Stat increases
            appState.user.stats.power += 2;
            appState.user.stats.resilience += 2;
            appState.user.stats.wisdom += 1;
            appState.user.stats.charisma += 1;
            appState.user.stats.luck += 1;
            
            // Resource increases
            appState.user.maxHealth += 10;
            appState.user.maxEnergy += 5;
            appState.user.maxFocus += 5;
            appState.user.health = appState.user.maxHealth;
            appState.user.energy = appState.user.maxEnergy;
            appState.user.focus = appState.user.maxFocus;
            
            // Rewards
            addGold(appState.user.level * 10);
            
            showLevelUp();
            updateClass();
            checkTitleUnlocks();
            checkMountUnlocks();
        }

        function updateHUD() {
            document.getElementById('xp-current').textContent = appState.user.xp;
            document.getElementById('xp-needed').textContent = calculateXPForLevel(appState.user.level + 1);
            document.getElementById('level-display').textContent = `Level ${appState.user.level}`;
            document.getElementById('class-display').textContent = appState.user.class;
            document.getElementById('title-display').textContent = appState.user.titles.equipped || '';
            document.getElementById('achievement-count').textContent = appState.user.achievements.length;
            document.getElementById('gold-count').textContent = appState.user.gold;
            document.getElementById('silver-count').textContent = appState.user.crystals;
            document.getElementById('daily-streak').textContent = appState.user.dailyStreak;
            
            // Stats
            document.getElementById('power-stat').textContent = appState.user.stats.power;
            document.getElementById('resilience-stat').textContent = appState.user.stats.resilience;
            document.getElementById('wisdom-stat').textContent = appState.user.stats.wisdom;
            
            // Resources
            const xpPercent = (appState.user.xp / calculateXPForLevel(appState.user.level + 1)) * 100;
            document.getElementById('xp-progress').style.width = `${xpPercent}%`;
            
            document.getElementById('health-bar').style.width = `${(appState.user.health / appState.user.maxHealth) * 100}%`;
            document.getElementById('energy-bar').style.width = `${(appState.user.energy / appState.user.maxEnergy) * 100}%`;
            document.getElementById('focus-bar').style.width = `${(appState.user.focus / appState.user.maxFocus) * 100}%`;
            
            // Companion
            const activeCompanion = appState.companions.find(c => c.active);
            if (activeCompanion) {
                document.getElementById('active-companion-icon').textContent = activeCompanion.icon;
                document.getElementById('active-companion-name').textContent = activeCompanion.name;
                document.getElementById('companion-affection').textContent = '❤️'.repeat(activeCompanion.affection) + '🤍'.repeat(activeCompanion.maxAffection - activeCompanion.affection);
            }
            
            // Calculate completion percentage
            const totalProjects = appState.projects.length;
            const visitedProjects = appState.user.visitedProjects.length;
            const completionPercent = totalProjects > 0 ? Math.floor((visitedProjects / totalProjects) * 100) : 0;
            document.getElementById('completion-percent').textContent = completionPercent;
        }

        function updateClass() {
            const classes = [
                { level: 1, name: 'Explorer', icon: '🔍' },
                { level: 5, name: 'Steward', icon: '🌱' },
                { level: 10, name: 'Peacekeeper', icon: '🕊️' },
                { level: 15, name: 'Architect', icon: '🏗️' },
                { level: 20, name: 'Guardian', icon: '🛡️' },
                { level: 30, name: 'Catalyst', icon: '⚡' },
                { level: 50, name: 'Legend', icon: '⭐' }
            ];
            
            for (let i = classes.length - 1; i >= 0; i--) {
                if (appState.user.level >= classes[i].level) {
                    if (appState.user.class !== classes[i].name) {
                        appState.user.class = classes[i].name;
                        showAchievementToast(`Class Evolution`, `You are now a ${classes[i].icon} ${classes[i].name}!`);
                    }
                    break;
                }
            }
        }

        function showLevelUp() {
            showAchievementToast('Level Up!', `You reached Level ${appState.user.level}!<br><small>+2 Power, +2 Resilience, +1 Wisdom</small>`);
        }

        function showAchievementToast(title, description) {
            const toast = document.createElement('div');
            toast.className = 'achievement-toast';
            toast.innerHTML = `
                <div style="font-size: 3rem; margin-bottom: var(--space-md);">🏆</div>
                <div style="font-size: 1.5rem; font-weight: bold; margin-bottom: var(--space-sm);">${title}</div>
                <div style="opacity: 0.9;">${description}</div>
            `;
            document.body.appendChild(toast);
            
            setTimeout(() => toast.remove(), 4000);
            
            // Play sound (if audio enabled)
            playSound('achievement');
        }

        function showAchievement(text) {
            const message = document.createElement('div');
            message.className = 'achievement-badge';
            message.style.position = 'fixed';
            message.style.top = '20px';
            message.style.right = '20px';
            message.style.zIndex = '10000';
            message.innerHTML = `<span>🏆</span> ${text}`;
            document.body.appendChild(message);
            
            appState.user.achievements.push({ text, timestamp: Date.now() });
            
            setTimeout(() => {
                message.style.opacity = '0';
                setTimeout(() => message.remove(), 500);
            }, 5000);
        }

        function showFloatingText(text, type = 'default') {
            const colors = {
                'xp': '#fbbf24',
                'gold': '#f59e0b',
                'damage': '#ef4444',
                'heal': '#10b981',
                'default': '#ffffff'
            };
            
            const floater = document.createElement('div');
            floater.style.position = 'fixed';
            floater.style.left = '50%';
            floater.style.top = '50%';
            floater.style.transform = 'translate(-50%, -50%)';
            floater.style.color = colors[type] || colors.default;
            floater.style.fontSize = '2rem';
            floater.style.fontWeight = 'bold';
            floater.style.textShadow = '0 2px 4px rgba(0,0,0,0.5)';
            floater.style.pointerEvents = 'none';
            floater.style.zIndex = '10001';
            floater.textContent = text;
            
            document.body.appendChild(floater);
            
            let opacity = 1;
            let y = 0;
            const animate = () => {
                y -= 2;
                opacity -= 0.02;
                floater.style.transform = `translate(-50%, calc(-50% + ${y}px))`;
                floater.style.opacity = opacity;
                
                if (opacity > 0) {
                    requestAnimationFrame(animate);
                } else {
                    floater.remove();
                }
            };
            requestAnimationFrame(animate);
        }

        // ═══════════════════════════════════════════════════════════════
        // RESOURCE MANAGEMENT
        // What: Health, Energy, Focus regeneration and consumption
        // How: Interval-based ticks, activity-based drain
        // Expected: Dynamic resource management, strategic planning
        // ═══════════════════════════════════════════════════════════════
        
        function consumeEnergy(amount) {
            appState.user.energy = Math.max(0, appState.user.energy - amount);
            updateHUD();
            
            if (appState.user.energy === 0) {
                showFloatingText('Out of Energy!', 'damage');
            }
        }

        function consumeFocus(amount) {
            appState.user.focus = Math.max(0, appState.user.focus - amount);
            updateHUD();
        }

        function regenerateResources() {
            // Passive regeneration
            const regenRate = 1 + (appState.user.stats.resilience / 100);
            
            if (appState.user.energy < appState.user.maxEnergy) {
                appState.user.energy = Math.min(appState.user.maxEnergy, appState.user.energy + regenRate);
            }
            
            if (appState.user.focus < appState.user.maxFocus) {
                appState.user.focus = Math.min(appState.user.maxFocus, appState.user.focus + regenRate);
            }
            
            if (appState.user.health < appState.user.maxHealth) {
                appState.user.health = Math.min(appState.user.maxHealth, appState.user.health + (regenRate * 0.5));
            }
            
            updateHUD();
        }

        // Start regeneration ticker
        setInterval(regenerateResources, 5000); // Every 5 seconds

        // ═══════════════════════════════════════════════════════════════
        // CURRENCY SYSTEM
        // What: Gold, crystals, and special tokens
        // How: Earning, spending, exchange rates
        // Expected: Meaningful economy, purchase decisions
        // ═══════════════════════════════════════════════════════════════
        
        function addGold(amount) {
            const luckBonus = appState.user.stats.luck / 100;
            const finalAmount = Math.floor(amount * (1 + luckBonus + appState.user.derived.goldFind / 100));
            appState.user.gold += finalAmount;
            showFloatingText(`+${finalAmount} 🪙`, 'gold');
            updateHUD();
            saveToDB('userData', { id: 'currentUser', data: appState.user });
        }

        function addCrystals(amount) {
            appState.user.crystals += amount;
            showFloatingText(`+${amount} 💎`, 'default');
            updateHUD();
            saveToDB('userData', { id: 'currentUser', data: appState.user });
        }

        function spendGold(amount) {
            if (appState.user.gold >= amount) {
                appState.user.gold -= amount;
                updateHUD();
                saveToDB('userData', { id: 'currentUser', data: appState.user });
                return true;
            }
            showFloatingText('Not enough gold!', 'damage');
            return false;
        }

        // ═══════════════════════════════════════════════════════════════
        // COMPANION SYSTEM
        // What: Unlock, activate, level up companions
        // How: Affection system, bonus tracking, story progression
        // Expected: Emotional connection, strategic choices
        // ═══════════════════════════════════════════════════════════════
        
        function getActiveCompanionBonus(type) {
            const active = appState.companions.find(c => c.active && c.unlocked);
            if (active && active.bonus.type === type) {
                return active.bonus.value * (1 + active.affection / 10);
            }
            return 0;
        }

        function increaseCompanionAffection(companionId, amount = 1) {
            const companion = appState.companions.find(c => c.id === companionId);
            if (companion && companion.unlocked) {
                companion.affection = Math.min(companion.maxAffection, companion.affection + amount);
                
                if (companion.affection === companion.maxAffection) {
                    showAchievementToast('Maximum Affection!', `${companion.icon} ${companion.name} trusts you completely!`);
                }
                
                updateHUD();
            }
        }

        function activateCompanion(companionId) {
            // Deactivate all others
            appState.companions.forEach(c => c.active = false);
            
            const companion = appState.companions.find(c => c.id === companionId);
            if (companion && companion.unlocked) {
                companion.active = true;
                showFloatingText(`${companion.icon} ${companion.name} joined you!`, 'default');
                updateHUD();
            }
        }

        function checkCompanionUnlocks() {
            appState.companions.forEach(companion => {
                if (!companion.unlocked) {
                    let shouldUnlock = false;
                    
                    // Check unlock conditions
                    if (companion.id === 'terra' && appState.user.visitedProjects.filter(url => 
                        appState.projects.find(p => p.url === url)?.category === 'regen'
                    ).length >= 10) {
                        shouldUnlock = true;
                    }
                    
                    if (companion.id === 'phoenix' && appState.user.visitedProjects.filter(url => 
                        appState.projects.find(p => p.url === url)?.category === 'crisis'
                    ).length >= 5) {
                        shouldUnlock = true;
                    }
                    
                    if (companion.id === 'sage' && appState.user.level >= 10) {
                        shouldUnlock = true;
                    }
                    
                    if (shouldUnlock) {
                        companion.unlocked = true;
                        showAchievementToast('New Companion!', `${companion.icon} ${companion.name}<br><small>${companion.story}</small>`);
                    }
                }
            });
        }

        // ═══════════════════════════════════════════════════════════════
        // FACTION/REPUTATION SYSTEM
        // What: Reputation gain, rank progression, rewards
        // How: Activity tracking, threshold checks, unlock system
        // Expected: Long-term progression, exclusive rewards
        // ═══════════════════════════════════════════════════════════════
        
        function addReputation(factionId, amount) {
            const faction = appState.factions.find(f => f.id === factionId);
            if (!faction) return;
            
            const charismaBonus = appState.user.stats.charisma / 100;
            const companionBonus = getActiveCompanionBonus('reputation') / 100;
            const finalAmount = Math.floor(amount * (1 + charismaBonus + companionBonus));
            
            faction.reputation += finalAmount;
            
            // Update reputation level
            const oldLevel = faction.level;
            faction.level = getReputationLevel(faction.reputation);
            
            showFloatingText(`+${finalAmount} rep with ${faction.name}`, 'default');
            
            // Check for level up
            if (faction.level !== oldLevel) {
                const rewards = faction.rewards[faction.level];
                showAchievementToast(`${faction.icon} ${faction.name}`, `You are now ${faction.level}!`);
                
                // Grant rewards
                if (rewards) {
                    if (rewards.title) unlockTitle(rewards.title);
                    if (rewards.mount) unlockMount(rewards.mount);
                    if (rewards.companion) unlockCompanion(rewards.companion);
                }
            }
            
            updateHUD();
        }

        function getReputationLevel(rep) {
            if (rep < 0) return 'Hostile';
            if (rep < 100) return 'Unfriendly';
            if (rep < 1000) return 'Neutral';
            if (rep < 3000) return 'Friendly';
            if (rep < 9000) return 'Honored';
            if (rep < 21000) return 'Revered';
            return 'Exalted';
        }

        // ═══════════════════════════════════════════════════════════════
        // CHARACTER SHEET & MODAL SYSTEM
        // What: Full character screen with tabbed interface
        // How: Dynamic HTML generation, tab switching
        // Expected: Complete character overview, easy navigation
        // ═══════════════════════════════════════════════════════════════
        
        function openCharacterSheet(tab = 'stats') {
            document.getElementById('character-sheet-modal').classList.add('active');
            switchTab(tab);
        }

        function closeCharacterSheet() {
            document.getElementById('character-sheet-modal').classList.remove('active');
        }

        function switchTab(tabName) {
            // Update active tab button
            document.querySelectorAll('.modal-tab').forEach(btn => {
                btn.classList.remove('active');
            });
            event?.target?.classList.add('active') || document.querySelector(`[onclick*="${tabName}"]`)?.classList.add('active');
            
            const content = document.getElementById('tab-content');
            
            switch(tabName) {
                case 'stats':
                    content.innerHTML = renderStatsTab();
                    break;
                case 'skills':
                    content.innerHTML = renderSkillsTab();
                    break;
                case 'inventory':
                    content.innerHTML = renderInventoryTab();
                    break;
                case 'companions':
                    content.innerHTML = renderCompanionsTab();
                    break;
                case 'mounts':
                    content.innerHTML = renderMountsTab();
                    break;
                case 'titles':
                    content.innerHTML = renderTitlesTab();
                    break;
                case 'factions':
                    content.innerHTML = renderFactionsTab();
                    break;
                case 'crafting':
                    content.innerHTML = renderCraftingTab();
                    break;
                case 'habits':
                    content.innerHTML = renderHabitsTab();
                    break;
            }
        }

        function renderStatsTab() {
            return `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: var(--space-xl);">
                    <div>
                        <h3 style="margin-bottom: var(--space-md);">Core Attributes</h3>
                        <div style="display: flex; flex-direction: column; gap: var(--space-sm);">
                            ${Object.entries(appState.user.stats).map(([stat, value]) => `
                                <div style="background: var(--bg-tertiary); padding: var(--space-md); border-radius: 8px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <span style="text-transform: capitalize;">${stat}</span>
                                        <strong style="font-size: 1.2rem;">${value}</strong>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    <div>
                        <h3 style="margin-bottom: var(--space-md);">Resources</h3>
                        <div style="display: flex; flex-direction: column; gap: var(--space-md);">
                            <div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: var(--space-xs);">
                                    <span>Health</span>
                                    <span>${Math.floor(appState.user.health)}/${appState.user.maxHealth}</span>
                                </div>
                                <div class="progress-bar" style="width: 100%; height: 20px;">
                                    <div class="progress-fill" style="width: ${(appState.user.health/appState.user.maxHealth)*100}%; background: linear-gradient(90deg, #ef4444, #dc2626);"></div>
                                </div>
                            </div>
                            <div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: var(--space-xs);">
                                    <span>Energy</span>
                                    <span>${Math.floor(appState.user.energy)}/${appState.user.maxEnergy}</span>
                                </div>
                                <div class="progress-bar" style="width: 100%; height: 20px;">
                                    <div class="progress-fill" style="width: ${(appState.user.energy/appState.user.maxEnergy)*100}%; background: linear-gradient(90deg, #3b82f6, #2563eb);"></div>
                                </div>
                            </div>
                            <div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: var(--space-xs);">
                                    <span>Focus</span>
                                    <span>${Math.floor(appState.user.focus)}/${appState.user.maxFocus}</span>
                                </div>
                                <div class="progress-bar" style="width: 100%; height: 20px;">
                                    <div class="progress-fill" style="width: ${(appState.user.focus/appState.user.maxFocus)*100}%; background: linear-gradient(90deg, #a855f7, #9333ea);"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderSkillsTab() {
            let html = '<div class="skill-tree">';
            
            Object.entries(appState.skills).forEach(([treeId, tree]) => {
                html += `
                    <div class="skill-branch">
                        <h3 style="margin-bottom: var(--space-lg); display: flex; align-items: center; gap: var(--space-sm);">
                            <span style="font-size: 1.5rem;">${tree.icon}</span>
                            ${tree.name}
                        </h3>
                        ${tree.nodes.map(node => {
                            const isLocked = !node.unlocked || appState.user.level < node.level;
                            const isAvailable = node.unlocked && appState.user.level >= node.level && node.currentLevel < node.maxLevel;
                            const className = isLocked ? 'locked' : isAvailable ? 'available' : 'unlocked';
                            
                            return `
                                <div class="skill-node ${className}" onclick="${isAvailable ? `unlockSkill('${treeId}', '${node.id}')` : ''}">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-sm);">
                                        <strong>${node.name}</strong>
                                        <span style="font-size: 0.85rem; color: var(--text-secondary);">${node.currentLevel}/${node.maxLevel}</span>
                                    </div>
                                    <div style="font-size: 0.85rem; color: var(--text-secondary); margin-bottom: var(--space-sm);">
                                        ${node.description}
                                    </div>
                                    ${isLocked ? `<div style="font-size: 0.85rem; color: var(--accent-danger);">Requires level ${node.level}</div>` : ''}
                                    ${isAvailable ? `<div style="font-size: 0.85rem; color: var(--accent-success);">Click to unlock!</div>` : ''}
                                </div>
                            `;
                        }).join('')}
                    </div>
                `;
            });
            
            html += '</div>';
            return html;
        }

        function unlockSkill(treeId, nodeId) {
            const node = appState.skills[treeId].nodes.find(n => n.id === nodeId);
            if (node && node.currentLevel < node.maxLevel) {
                node.currentLevel++;
                showFloatingText(`${node.name} +1`, 'default');
                switchTab('skills'); // Refresh
                
                // Apply effects
                applySkillEffect(node);
            }
        }

        function applySkillEffect(node) {
            switch(node.effect) {
                case 'xpBonus':
                    appState.user.derived.xpBonus += 10;
                    break;
                case 'factionBonus':
                    // Applied in addReputation function
                    break;
                // Add more effect handlers
            }
        }

        function updateSkillAvailability() {
            // Check and unlock skills based on prerequisites
            Object.values(appState.skills).forEach(tree => {
                tree.nodes.forEach(node => {
                    if (!node.unlocked && (!node.requires || node.requires.length === 0)) {
                        // Root nodes always unlocked
                        node.unlocked = true;
                    } else if (!node.unlocked && node.requires) {
                        // Check if all requirements met
                        const allRequirementsMet = node.requires.every(reqId => {
                            const reqNode = tree.nodes.find(n => n.id === reqId);
                            return reqNode && reqNode.currentLevel > 0;
                        });
                        
                        if (allRequirementsMet) {
                            node.unlocked = true;
                        }
                    }
                });
            });
        }

        function renderInventoryTab() {
            let html = '<div class="inventory-grid">';
            
            // Render items
            appState.inventory.items.forEach(item => {
                html += `
                    <div class="inventory-slot item-quality-${item.quality}" title="${item.description}" onclick="useItem('${item.id}')">
                        <span style="font-size: 2rem;">${item.icon}</span>
                        ${item.count > 1 ? `<span class="item-count">${item.count}</span>` : ''}
                    </div>
                `;
            });
            
            // Empty slots
            const emptySlots = appState.inventory.maxSlots - appState.inventory.items.length;
            for (let i = 0; i < emptySlots; i++) {
                html += '<div class="inventory-slot empty"></div>';
            }
            
            html += '</div>';
            return html;
        }

        function useItem(itemId) {
            const item = appState.inventory.items.find(i => i.id === itemId);
            if (!item || !item.usable) return;
            
            switch(item.id) {
                case 'scroll_peace':
                    addReputation('peacekeeper_alliance', 50);
                    break;
                case 'crystal_focus':
                    appState.user.focus = Math.min(appState.user.maxFocus, appState.user.focus + 50);
                    updateHUD();
                    break;
            }
            
            // Consume item
            item.count--;
            if (item.count <= 0) {
                appState.inventory.items = appState.inventory.items.filter(i => i.id !== itemId);
            }
            
            showFloatingText(`Used ${item.icon} ${item.name}`, 'default');
            switchTab('inventory'); // Refresh
        }

        function renderCompanionsTab() {
            return `
                <div class="companion-grid">
                    ${appState.companions.map(companion => `
                        <div class="companion-card ${companion.active ? 'active' : ''} ${!companion.unlocked ? 'locked' : ''}" 
                             onclick="${companion.unlocked ? `activateCompanion('${companion.id}')` : ''}">
                            <div class="companion-avatar">${companion.icon}</div>
                            <h3>${companion.name}</h3>
                            <div style="color: var(--text-secondary); font-size: 0.85rem; margin-bottom: var(--space-sm);">${companion.role}</div>
                            ${companion.unlocked ? `
                                <div class="companion-affection">
                                    ${'<span class="affection-heart filled">❤️</span>'.repeat(companion.affection)}
                                    ${'<span class="affection-heart empty">🤍</span>'.repeat(companion.maxAffection - companion.affection)}
                                </div>
                                <div style="margin-top: var(--space-sm); font-size: 0.85rem;">
                                    <strong>Bonus:</strong> +${companion.bonus.value}% ${companion.bonus.type}
                                </div>
                            ` : `
                                <div style="color: var(--accent-warning); font-size: 0.85rem; margin-top: var(--space-md);">
                                    🔒 ${companion.unlockRequirement}
                                </div>
                            `}
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function renderMountsTab() {
            return `
                <div class="mount-grid">
                    ${appState.mounts.map(mount => `
                        <div class="mount-card ${mount.unlocked ? 'unlocked' : 'locked'}"
                             onclick="${mount.unlocked ? `activateMount('${mount.id}')` : ''}">
                            <div class="mount-icon">${mount.icon}</div>
                            <div style="font-weight: 600; margin-bottom: var(--space-xs);">${mount.name}</div>
                            <div class="mount-speed">Speed: ${mount.speed}%</div>
                            ${!mount.unlocked ? `
                                <div style="color: var(--accent-warning); font-size: 0.75rem; margin-top: var(--space-sm);">
                                    ${mount.requirement}
                                </div>
                            ` : ''}
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function activateMount(mountId) {
            const mount = appState.mounts.find(m => m.id === mountId);
            if (mount && mount.unlocked) {
                appState.user.activeMount = mountId;
                appState.user.mountSpeed = mount.speed;
                showFloatingText(`Mounted: ${mount.icon} ${mount.name}`, 'default');
            }
        }

        function checkMountUnlocks() {
            appState.mounts.forEach(mount => {
                if (!mount.unlocked) {
                    let shouldUnlock = false;
                    
                    if (mount.id === 'bicycle' && appState.user.level >= 5) shouldUnlock = true;
                    if (mount.id === 'horse' && appState.factions.some(f => f.level === 'Honored' || f.level === 'Revered' || f.level === 'Exalted')) shouldUnlock = true;
                    if (mount.id === 'griffin' && appState.user.visitedProjects.length >= 50) shouldUnlock = true;
                    if (mount.id === 'dragon' && appState.factions.filter(f => f.level === 'Exalted').length >= 3) shouldUnlock = true;
                    
                    if (shouldUnlock && appState.user.gold >= mount.cost) {
                        mount.unlocked = true;
                        appState.user.gold -= mount.cost;
                        showAchievementToast('New Mount!', `${mount.icon} ${mount.name} unlocked!`);
                    }
                }
            });
        }

        function renderTitlesTab() {
            return `
                <div class="title-grid">
                    ${appState.titleCollection.map(title => `
                        <div class="title-card ${title.unlocked ? 'unlocked' : 'locked'} ${appState.user.titles.equipped === title.name ? 'equipped' : ''}"
                             onclick="${title.unlocked ? `equipTitle('${title.name}')` : ''}">
                            <div class="title-text">${title.name}</div>
                            <div style="font-size: 0.85rem; color: var(--text-secondary);">
                                ${title.requirement}
                            </div>
                            ${title.unlocked && appState.user.titles.equipped === title.name ? `
                                <div style="margin-top: var(--space-sm); color: var(--accent-success); font-weight: 600;">
                                    ✓ Equipped
                                </div>
                            ` : ''}
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function equipTitle(titleName) {
            appState.user.titles.equipped = titleName;
            updateHUD();
            switchTab('titles'); // Refresh
            showFloatingText(`Title equipped: ${titleName}`, 'default');
        }

        function unlockTitle(titleId) {
            const title = appState.titleCollection.find(t => t.id === titleId);
            if (title && !title.unlocked) {
                title.unlocked = true;
                showAchievementToast('New Title!', `"${title.name}" unlocked!`);
            }
        }

        function checkTitleUnlocks() {
            appState.titleCollection.forEach(title => {
                if (!title.unlocked) {
                    let shouldUnlock = false;
                    
                    if (title.id === 'explorer' && appState.user.visitedProjects.length >= 10) shouldUnlock = true;
                    if (title.id === 'steward' && appState.user.visitedProjects.filter(url => 
                        appState.projects.find(p => p.url === url)?.category === 'regen'
                    ).length >= 5) shouldUnlock = true;
                    if (title.id === 'hero' && appState.user.level >= 20) shouldUnlock = true;
                    if (title.id === 'legend' && appState.user.visitedProjects.length >= 100) shouldUnlock = true;
                    
                    if (shouldUnlock) {
                        title.unlocked = true;
                        showAchievementToast('New Title!', `"${title.name}" unlocked!`);
                    }
                }
            });
        }

        function renderFactionsTab() {
            return `
                <div class="faction-list">
                    ${appState.factions.map(faction => {
                        const repPercent = Math.min(100, (faction.reputation / 21000) * 100);
                        return `
                            <div class="faction-item">
                                <div class="faction-header">
                                    <div class="faction-name">
                                        <span style="font-size: 1.5rem;">${faction.icon}</span>
                                        <span>${faction.name}</span>
                                    </div>
                                    <span class="reputation-level rep-${faction.level.toLowerCase()}">${faction.level}</span>
                                </div>
                                <div style="color: var(--text-secondary); font-size: 0.85rem; margin-bottom: var(--space-md);">
                                    ${faction.description}
                                </div>
                                <div class="progress-bar" style="width: 100%; height: 16px;">
                                    <div class="progress-fill" style="width: ${repPercent}%"></div>
                                </div>
                                <div style="font-size: 0.85rem; color: var(--text-secondary); margin-top: var(--space-xs);">
                                    ${faction.reputation} / 21000 reputation
                                </div>
                            </div>
                        `;
                    }).join('')}
                </div>
            `;
        }

        function renderCraftingTab() {
            return `
                <div>
                    <h3 style="margin-bottom: var(--space-lg);">Recipes</h3>
                    ${appState.crafting.recipes.map(recipe => {
                        const canCraft = recipe.ingredients.every(ing => {
                            const item = appState.inventory.items.find(i => i.id === ing.id);
                            return item && item.count >= ing.count;
                        });
                        
                        return `
                            <div class="crafting-recipe">
                                <div style="display: flex; align-items: center; gap: var(--space-md); margin-bottom: var(--space-md);">
                                    <span style="font-size: 2rem;">${recipe.icon}</span>
                                    <div>
                                        <strong>${recipe.name}</strong>
                                        <div style="font-size: 0.85rem; color: var(--text-secondary);">
                                            ${recipe.profession} (Level ${recipe.level})
                                        </div>
                                    </div>
                                </div>
                                <div class="recipe-ingredients">
                                    ${recipe.ingredients.map(ing => {
                                        const item = appState.inventory.items.find(i => i.id === ing.id);
                                        const has = item ? item.count : 0;
                                        const className = has >= ing.count ? 'have' : 'need';
                                        return `<span class="ingredient ${className}">${ing.id}: ${has}/${ing.count}</span>`;
                                    }).join('')}
                                </div>
                                <button class="craft-btn" ${!canCraft || !recipe.unlocked ? 'disabled' : ''} 
                                        onclick="craftItem('${recipe.id}')">
                                    ${canCraft && recipe.unlocked ? 'Craft' : !recipe.unlocked ? 'Locked' : 'Missing Materials'}
                                </button>
                            </div>
                        `;
                    }).join('')}
                </div>
            `;
        }

        function craftItem(recipeId) {
            const recipe = appState.crafting.recipes.find(r => r.id === recipeId);
            if (!recipe) return;
            
            // Consume ingredients
            recipe.ingredients.forEach(ing => {
                const item = appState.inventory.items.find(i => i.id === ing.id);
                if (item) {
                    item.count -= ing.count;
                    if (item.count <= 0) {
                        appState.inventory.items = appState.inventory.items.filter(i => i.id !== ing.id);
                    }
                }
            });
            
            // Add result
            const existing = appState.inventory.items.find(i => i.id === recipe.result.id);
            if (existing) {
                existing.count += recipe.result.count;
            } else {
                // Would need full item definition here
                showFloatingText('Item crafted!', 'default');
            }
            
            switchTab('crafting'); // Refresh
        }

        function renderHabitsTab() {
            return `
                <div class="habit-list">
                    ${appState.habits.map(habit => `
                        <div class="habit-item">
                            <div class="habit-buttons">
                                ${habit.positive ? `<button class="habit-btn plus" onclick="habitAction('${habit.id}', 1)">+</button>` : ''}
                                ${habit.negative ? `<button class="habit-btn minus" onclick="habitAction('${habit.id}', -1)">−</button>` : ''}
                            </div>
                            <div style="flex: 1;">
                                <div style="display: flex; align-items: center; gap: var(--space-sm); margin-bottom: var(--space-xs);">
                                    <span style="font-size: 1.2rem;">${habit.icon}</span>
                                    <strong>${habit.name}</strong>
                                </div>
                                <div class="progress-bar" style="width: 200px; height: 12px;">
                                    <div class="progress-fill" style="width: ${((habit.value + 10) / 20) * 100}%; background: ${habit.value >= 0 ? 'linear-gradient(90deg, #10b981, #059669)' : 'linear-gradient(90deg, #ef4444, #dc2626)'}"></div>
                                </div>
                            </div>
                            ${habit.streak > 0 ? `<div class="habit-streak">🔥 ${habit.streak} day${habit.streak !== 1 ? 's' : ''}</div>` : ''}
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function habitAction(habitId, direction) {
            const habit = appState.habits.find(h => h.id === habitId);
            if (!habit) return;
            
            habit.value = Math.max(-10, Math.min(10, habit.value + direction));
            
            if (direction > 0) {
                addXP(habit.xpReward);
                addGold(habit.goldReward);
                habit.streak++;
                showFloatingText(`+${habit.xpReward} XP`, 'xp');
            } else {
                appState.user.health = Math.max(0, appState.user.health - 10);
                habit.streak = 0;
                showFloatingText('-10 Health', 'damage');
            }
            
            updateHUD();
            switchTab('habits'); // Refresh
        }

        function togglePanel(panel) {
            const expanded = panel.querySelector('.panel-expanded');
            if (expanded) {
                const isVisible = expanded.style.display !== 'none';
                expanded.style.display = isVisible ? 'none' : 'block';
            }
        }

        function playSound(soundType) {
            // Placeholder for sound system
            // Would integrate Web Audio API or HTML5 Audio
        }

        // ═══════════════════════════════════════════════════════════════
        // TRAIT DISCOVERY SYSTEM
        // What: Dynamic trait unlocking based on user behavior
        // How: Pattern recognition, threshold tracking, skill trees
        // Expected: Personalized character development, meaningful choices
        // ═══════════════════════════════════════════════════════════════
        
        function initTraits() {
            appState.traits = [
                { id: 'peacemaker', name: 'Peacemaker', icon: '🕊️', description: 'Visit 5 peace projects', progress: 0, required: 5, unlocked: false },
                { id: 'ecologist', name: 'Ecologist', icon: '🌿', description: 'Explore 5 restoration nodes', progress: 0, required: 5, unlocked: false },
                { id: 'responder', name: 'First Responder', icon: '🚨', description: 'Review 3 crisis systems', progress: 0, required: 3, unlocked: false },
                { id: 'educator', name: 'Educator', icon: '📚', description: 'Complete 3 learning modules', progress: 0, required: 3, unlocked: false },
                { id: 'architect', name: 'Systems Architect', icon: '🏗️', description: 'Study 5 governance frameworks', progress: 0, required: 5, unlocked: false },
                { id: 'explorer', name: 'Deep Explorer', icon: '🔍', description: 'Visit 20 unique projects', progress: 0, required: 20, unlocked: false }
            ];
            renderTraits();
        }

        function updateTraitProgress(projectCategory) {
            const traitMap = {
                'peace': 'peacemaker',
                'regen': 'ecologist',
                'crisis': 'responder',
                'education': 'educator',
                'governance': 'architect'
            };

            const traitId = traitMap[projectCategory];
            if (traitId) {
                const trait = appState.traits.find(t => t.id === traitId);
                if (trait && !trait.unlocked) {
                    trait.progress++;
                    if (trait.progress >= trait.required) {
                        trait.unlocked = true;
                        appState.user.unlockedTraits.push(traitId);
                        showAchievement(`Trait Unlocked: ${trait.icon} ${trait.name}`);
                    }
                    renderTraits();
                }
            }

            // Deep Explorer trait
            const explorerTrait = appState.traits.find(t => t.id === 'explorer');
            if (explorerTrait) {
                explorerTrait.progress = appState.user.visitedProjects.length;
                if (explorerTrait.progress >= explorerTrait.required && !explorerTrait.unlocked) {
                    explorerTrait.unlocked = true;
                    appState.user.unlockedTraits.push('explorer');
                    showAchievement(`Trait Unlocked: ${explorerTrait.icon} ${explorerTrait.name}`);
                }
                renderTraits();
            }
        }

        function renderTraits() {
            const container = document.getElementById('traits-container');
            container.innerHTML = appState.traits.map(trait => `
                <div class="trait-card ${trait.unlocked ? 'unlocked' : 'locked'}" title="${trait.description}">
                    <div class="trait-icon">${trait.icon}</div>
                    <div class="trait-name">${trait.name}</div>
                    <div class="trait-description">
                        ${trait.unlocked ? 'Unlocked!' : `${trait.progress}/${trait.required}`}
                    </div>
                </div>
            `).join('');
        }

        // ═══════════════════════════════════════════════════════════════
        // QUEST SYSTEM (WOW/SWTOR-style)
        // What: Daily/weekly/story quests with varied objectives
        // How: Task tracking, time-based reset, progressive difficulty
        // Expected: Engaging objectives, clear rewards, sense of purpose
        // ═══════════════════════════════════════════════════════════════
        
        function initQuests() {
            appState.quests = [
                {
                    id: 'daily_explorer',
                    title: 'Daily Explorer',
                    description: 'Visit 3 new projects today',
                    progress: 0,
                    required: 3,
                    rewards: { xp: 50, gold: 25, crystals: 1 },
                    type: 'daily',
                    icon: '🔍'
                },
                {
                    id: 'category_master',
                    title: 'Category Master',
                    description: 'Explore all 5 main categories',
                    progress: 0,
                    required: 5,
                    rewards: { xp: 100, gold: 50, title: 'the Versatile' },
                    type: 'weekly',
                    icon: '🎯'
                },
                {
                    id: 'deep_dive',
                    title: 'Deep Dive',
                    description: 'Spend 10 minutes exploring the archive',
                    progress: 0,
                    required: 10,
                    rewards: { xp: 75, gold: 30 },
                    type: 'daily',
                    icon: '⏱️'
                },
                {
                    id: 'faction_friend',
                    title: 'Making Friends',
                    description: 'Reach Friendly status with any faction',
                    progress: 0,
                    required: 1,
                    rewards: { xp: 150, gold: 100, crystals: 3 },
                    type: 'achievement',
                    icon: '🤝'
                },
                {
                    id: 'skill_investor',
                    title: 'Skill Investor',
                    description: 'Unlock 5 skills across all trees',
                    progress: 0,
                    required: 5,
                    rewards: { xp: 200, gold: 150, item: 'skill_tome' },
                    type: 'achievement',
                    icon: '📖'
                },
                {
                    id: 'restoration_hero',
                    title: 'Restoration Hero',
                    description: 'Complete 10 restoration projects',
                    progress: 0,
                    required: 10,
                    rewards: { xp: 250, gold: 200, companion: 'terra' },
                    type: 'story',
                    icon: '🌱'
                },
                {
                    id: 'peace_ambassador',
                    title: 'Ambassador of Peace',
                    description: 'Complete 10 peace projects',
                    progress: 0,
                    required: 10,
                    rewards: { xp: 250, gold: 200, title: 'Peacekeeper' },
                    type: 'story',
                    icon: '🕊️'
                },
                {
                    id: 'habit_builder',
                    title: 'Building Good Habits',
                    description: 'Complete any habit 10 times',
                    progress: 0,
                    required: 10,
                    rewards: { xp: 100, gold: 75, crystals: 2 },
                    type: 'achievement',
                    icon: '✅'
                }
            ];
            renderQuests();
        }

        function updateQuestProgress(questId, amount = 1) {
            const quest = appState.quests.find(q => q.id === questId);
            if (quest && quest.progress < quest.required) {
                quest.progress = Math.min(quest.required, quest.progress + amount);
                
                if (quest.progress >= quest.required) {
                    completeQuest(quest);
                }
                renderQuests();
            }
        }

        function completeQuest(quest) {
            // Grant rewards
            if (quest.rewards.xp) addXP(quest.rewards.xp);
            if (quest.rewards.gold) addGold(quest.rewards.gold);
            if (quest.rewards.crystals) addCrystals(quest.rewards.crystals);
            if (quest.rewards.title) unlockTitle(quest.rewards.title);
            if (quest.rewards.companion) {
                const companion = appState.companions.find(c => c.id === quest.rewards.companion);
                if (companion) companion.unlocked = true;
            }
            
            showAchievementToast(
                'Quest Complete!',
                `${quest.icon} ${quest.title}<br><small>+${quest.rewards.xp} XP, +${quest.rewards.gold} Gold</small>`
            );
            
            // Mark as completed (for daily/weekly, reset on new day/week)
            if (quest.type === 'daily' || quest.type === 'weekly') {
                quest.completedToday = true;
            } else {
                // Remove achievement/story quests when complete
                appState.user.completedQuests.push(quest.id);
            }
        }

        function renderQuests() {
            const container = document.getElementById('quests-container');
            const activeQuests = appState.quests.filter(q => 
                !appState.user.completedQuests.includes(q.id) && 
                (!q.completedToday || q.type === 'daily' || q.type === 'weekly')
            );
            
            container.innerHTML = activeQuests.map(quest => `
                <div class="quest-item">
                    <div class="quest-header">
                        <div style="display: flex; align-items: center; gap: var(--space-sm);">
                            <span style="font-size: 1.2rem;">${quest.icon}</span>
                            <div class="quest-title">${quest.title}</div>
                            <span style="font-size: 0.75rem; padding: 2px 6px; background: var(--bg-secondary); border-radius: 4px; color: var(--text-secondary);">
                                ${quest.type}
                            </span>
                        </div>
                        <div class="quest-reward">
                            ${quest.rewards.xp ? `+${quest.rewards.xp} XP` : ''}
                            ${quest.rewards.gold ? ` +${quest.rewards.gold} 🪙` : ''}
                        </div>
                    </div>
                    <div style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: var(--space-sm);">
                        ${quest.description}
                    </div>
                    <div class="quest-progress">
                        <div class="progress-bar" style="flex: 1;">
                            <div class="progress-fill" style="width: ${(quest.progress / quest.required) * 100}%"></div>
                        </div>
                        <span style="font-size: 0.85rem; color: var(--text-secondary);">
                            ${quest.progress}/${quest.required}
                        </span>
                    </div>
                </div>
            `).join('');
            
            document.getElementById('quest-count').textContent = activeQuests.length;
        }

        // ═══════════════════════════════════════════════════════════════
        // PROJECT RENDERING & INTERACTION
        // What: Display project cards, handle clicks, track visits
        // How: Dynamic HTML generation, event delegation, analytics
        // Expected: Fast rendering, smooth interactions, data persistence
        // ═══════════════════════════════════════════════════════════════
        
        function renderProjects() {
            const container = document.getElementById('content-grid');
            let filteredProjects = appState.projects;

            // Apply category filter
            if (appState.currentFilter !== 'all') {
                filteredProjects = filteredProjects.filter(p => p.category === appState.currentFilter);
            }

            // Apply search filter
            if (appState.searchQuery) {
                const query = appState.searchQuery.toLowerCase();
                filteredProjects = filteredProjects.filter(p => 
                    p.title.toLowerCase().includes(query) ||
                    p.description.toLowerCase().includes(query) ||
                    p.tags.some(tag => tag.toLowerCase().includes(query)) ||
                    (p.location && p.location.toLowerCase().includes(query))
                );
            }

            container.innerHTML = filteredProjects.map(project => `
                <article class="project-card" data-url="${project.url}" onclick="visitProject('${project.url}')">
                    <div class="project-header">
                        <div>
                            <h3 class="project-title">${project.title}</h3>
                            ${project.location ? `<span style="font-size: 0.85rem; color: var(--text-secondary);">📍 ${project.location}</span>` : ''}
                        </div>
                        <span class="project-category">${project.category}</span>
                    </div>
                    <p class="project-description">${project.description}</p>
                    <div class="project-tags">
                        ${project.tags.slice(0, 4).map(tag => `<span class="tag">${tag}</span>`).join('')}
                    </div>
                    <div class="project-stats">
                        <span class="stat">👁️ ${project.visits} visits</span>
                        <span class="stat">⭐ +${project.xpReward} XP</span>
                    </div>
                </article>
            `).join('');

            if (filteredProjects.length === 0) {
                container.innerHTML = '<div class="error-message">No projects found matching your criteria. Try adjusting your filters or search terms.</div>';
            }
        }

        function visitProject(url) {
            const project = appState.projects.find(p => p.url === url);
            if (!project) return;

            // Check energy requirement
            const energyCost = 5;
            if (appState.user.energy < energyCost) {
                showFloatingText('Not enough energy!', 'damage');
                return;
            }

            // Consume energy
            consumeEnergy(energyCost);
            consumeFocus(3);

            // Track visit
            project.visits++;
            const isFirstVisit = !appState.user.visitedProjects.includes(url);
            
            if (isFirstVisit) {
                appState.user.visitedProjects.push(url);
                
                // XP reward with bonuses
                const baseXP = project.xpReward;
                addXP(baseXP);
                
                // Gold reward
                const goldReward = Math.floor(5 + (appState.user.level * 0.5));
                addGold(goldReward);
                
                // Faction reputation
                const factionMap = {
                    'peace': 'peacekeeper_alliance',
                    'regen': 'restoration_circle',
                    'education': 'knowledge_keepers',
                    'crisis': 'crisis_responders'
                };
                
                const factionId = factionMap[project.category];
                if (factionId) {
                    addReputation(factionId, 10);
                }
                
                // Update trait progress
                updateTraitProgress(project.category);
                
                // Quest progress
                updateQuestProgress('daily_explorer');
                
                // Track unique categories for category master quest
                const uniqueCategories = new Set(
                    appState.user.visitedProjects.map(u => 
                        appState.projects.find(p => p.url === u)?.category
                    ).filter(Boolean)
                );
                const categoryQuest = appState.quests.find(q => q.id === 'category_master');
                if (categoryQuest) {
                    categoryQuest.progress = uniqueCategories.size;
                }
                
                // Companion affection gain
                const activeCompanion = appState.companions.find(c => c.active);
                if (activeCompanion) {
                    increaseCompanionAffection(activeCompanion.id, 0.1);
                }
                
                // Check unlocks
                checkTitleUnlocks();
                checkCompanionUnlocks();
                checkMountUnlocks();
            }

            // Open in new tab
            window.open(url, '_blank');
            
            renderProjects();
            saveToDB('userData', { id: 'currentUser', data: appState.user });
        }

        // ═══════════════════════════════════════════════════════════════
        // SEARCH & FILTER SYSTEM
        // What: Real-time search, category filtering, combined queries
        // How: Event listeners, debouncing, efficient re-rendering
        // Expected: Instant feedback, no lag, clear results
        // ═══════════════════════════════════════════════════════════════
        
        function filterContent(category) {
            appState.currentFilter = category;
            
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.filter === category) {
                    btn.classList.add('active');
                }
            });
            
            renderProjects();
        }

        let searchTimeout;
        document.addEventListener('DOMContentLoaded', () => {
            const searchInput = document.getElementById('search-input');
            searchInput.addEventListener('input', (e) => {
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(() => {
                    appState.searchQuery = e.target.value;
                    renderProjects();
                }, 300);
            });
        });

        // ═══════════════════════════════════════════════════════════════
        // AI ASSISTANT SYSTEM
        // What: Context-aware suggestions, natural language interaction
        // How: Pattern matching, project analysis, helpful responses
        // Expected: Helpful guidance, personalized recommendations
        // ═══════════════════════════════════════════════════════════════
        
        function aiSuggest(type) {
            const responses = {
                'projects': `Based on your ${appState.user.class} class and ${appState.user.level} level, I recommend exploring ${appState.currentFilter === 'all' ? 'peace and regeneration' : appState.currentFilter} projects. You've visited ${appState.user.visitedProjects.length} projects so far!`,
                'quests': `You have ${appState.quests.filter(q => q.progress < q.required).length} active quests. Focus on "${appState.quests[0].title}" to earn ${appState.quests[0].reward} XP!`,
                'traits': `You're close to unlocking new traits! ${appState.traits.filter(t => !t.unlocked && t.progress > 0).map(t => `${t.name}: ${t.progress}/${t.required}`).join(', ')}`,
                'impact': `You've explored ${appState.user.visitedProjects.length} projects and earned ${appState.user.xp + (appState.user.level - 1) * 100} total XP. Your ${appState.user.class} class is making a real difference!`
            };

            addAIMessage(responses[type] || 'I can help you explore the archive. What would you like to know?', 'assistant');
        }

        function sendToAI() {
            const input = document.getElementById('ai-input');
            const message = input.value.trim();
            if (!message) return;

            addAIMessage(message, 'user');
            input.value = '';

            // Simple keyword-based responses
            setTimeout(() => {
                let response = "That's an interesting question! Let me help you explore that topic.";
                
                if (message.toLowerCase().includes('peace')) {
                    response = `I found ${appState.projects.filter(p => p.category === 'peace').length} peace-related projects. Would you like me to show them?`;
                } else if (message.toLowerCase().includes('regen') || message.toLowerCase().includes('restore')) {
                    response = `There are ${appState.projects.filter(p => p.category === 'regen').length} restoration projects in the archive. Many focus on water and reforestation!`;
                } else if (message.toLowerCase().includes('level') || message.toLowerCase().includes('xp')) {
                    response = `You're currently Level ${appState.user.level} with ${appState.user.xp} XP. You need ${appState.user.level * 100 - appState.user.xp} more XP to reach Level ${appState.user.level + 1}!`;
                }

                addAIMessage(response, 'assistant');
            }, 800);
        }

        function addAIMessage(text, sender) {
            const chatContainer = document.getElementById('ai-chat');
            const message = document.createElement('div');
            message.className = `ai-message ${sender}`;
            message.textContent = text;
            chatContainer.appendChild(message);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        // Handle Enter key in AI input
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('ai-input').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') sendToAI();
            });
        });

        // ═══════════════════════════════════════════════════════════════
        // THEME SYSTEM
        // What: Multiple visual themes, automatic persistence
        // How: CSS custom properties, localStorage, smooth transitions
        // Expected: Instant theme changes, remembered preferences
        // ═══════════════════════════════════════════════════════════════
        
        function setTheme(theme) {
            document.documentElement.setAttribute('data-theme', theme);
            localStorage.setItem('preferred-theme', theme);
            
            document.querySelectorAll('.theme-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.theme === theme) {
                    btn.classList.add('active');
                }
            });
        }

        // Load saved theme
        document.addEventListener('DOMContentLoaded', () => {
            const savedTheme = localStorage.getItem('preferred-theme') || 'cosmic';
            setTheme(savedTheme);
        });

        // ═══════════════════════════════════════════════════════════════
        // PARALLAX CONSTELLATION BACKGROUND
        // What: Interactive starfield with parallax mouse tracking
        // How: Canvas API, particle system, requestAnimationFrame
        // Expected: Smooth 60fps animation, low CPU usage
        // ═══════════════════════════════════════════════════════════════
        
        function initConstellation() {
            const canvas = document.getElementById('constellation-canvas');
            const ctx = canvas.getContext('2d');
            
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;

            const stars = [];
            const starCount = 150;
            let mouseX = 0;
            let mouseY = 0;

            class Star {
                constructor() {
                    this.x = Math.random() * canvas.width;
                    this.y = Math.random() * canvas.height;
                    this.size = Math.random() * 2;
                    this.baseX = this.x;
                    this.baseY = this.y;
                    this.speed = Math.random() * 0.5;
                    this.opacity = Math.random();
                }

                update() {
                    // Parallax effect
                    const dx = (mouseX - canvas.width / 2) * 0.01 * this.speed;
                    const dy = (mouseY - canvas.height / 2) * 0.01 * this.speed;
                    
                    this.x = this.baseX + dx;
                    this.y = this.baseY + dy;

                    // Twinkle effect
                    this.opacity += (Math.random() - 0.5) * 0.02;
                    this.opacity = Math.max(0.3, Math.min(1, this.opacity));
                }

                draw() {
                    ctx.beginPath();
                    ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                    ctx.fillStyle = `rgba(224, 230, 255, ${this.opacity})`;
                    ctx.fill();
                }
            }

            // Initialize stars
            for (let i = 0; i < starCount; i++) {
                stars.push(new Star());
            }

            // Mouse tracking
            window.addEventListener('mousemove', (e) => {
                mouseX = e.clientX;
                mouseY = e.clientY;
            });

            // Animation loop
            function animate() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                stars.forEach(star => {
                    star.update();
                    star.draw();
                });

                requestAnimationFrame(animate);
            }

            animate();

            // Handle resize
            window.addEventListener('resize', () => {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            });
        }

        // ═══════════════════════════════════════════════════════════════
        // EXPORT FUNCTIONALITY
        // What: Export data as HTML, JSON, or print to PDF
        // How: Blob generation, download triggers, print API
        // Expected: Clean exports, proper formatting, no data loss
        // ═══════════════════════════════════════════════════════════════
        
        function exportData(format) {
            if (format === 'html') {
                const blob = new Blob([document.documentElement.outerHTML], { type: 'text/html' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `planetary-archive-${Date.now()}.html`;
                a.click();
                URL.revokeObjectURL(url);
            } else if (format === 'json') {
                const exportData = {
                    user: appState.user,
                    visitedProjects: appState.user.visitedProjects.map(url => 
                        appState.projects.find(p => p.url === url)
                    ),
                    exportDate: new Date().toISOString()
                };
                const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `planetary-archive-data-${Date.now()}.json`;
                a.click();
                URL.revokeObjectURL(url);
            }
            
            showAchievement('Data Exported Successfully!');
        }

        // ═══════════════════════════════════════════════════════════════
        // INITIALIZATION & STARTUP
        // What: Bootstrap application, load data, start systems
        // How: Sequential async operations, error handling, daily reset
        // Expected: Fast startup, graceful degradation, persistent state
        // ═══════════════════════════════════════════════════════════════
        
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize database
            initDB();

            // Parse and load projects
            appState.projects = parseProjects();
            
            // Initialize all game systems
            initQuests();
            initTraits();
            initSkills();
            
            // Check for daily reset
            checkDailyReset();
            
            // Render UI
            renderProjects();
            updateHUD();
            
            // Start constellation
            initConstellation();

            // Track session time for quest
            let sessionSeconds = 0;
            setInterval(() => {
                sessionSeconds++;
                appState.user.totalPlayTime++;
                updateQuestProgress('deep_dive', 1/60); // 1 minute = 60 seconds
                
                // Auto-save every minute
                if (sessionSeconds % 60 === 0) {
                    saveToDB('userData', { id: 'currentUser', data: appState.user });
                }
            }, 1000);

            // Resource regeneration already started globally

            console.log('%c🌍 Planetary Restoration Archive Initialized', 'color: #6366f1; font-size: 16px; font-weight: bold;');
            console.log(`%c${appState.projects.length} projects loaded`, 'color: #10b981;');
            console.log('%cZero-Harm Protocol Active ✓', 'color: #10b981;');
            console.log('%cUltra-Detailed Gamification: ACTIVE', 'color: #a855f7;');
            console.log(`%c${Object.keys(appState.skills).length} Skill Trees | ${appState.companions.length} Companions | ${appState.factions.length} Factions`, 'color: #fbbf24;');
        });

        function checkDailyReset() {
            const now = new Date();
            const lastLogin = appState.user.lastLoginDate ? new Date(appState.user.lastLoginDate) : null;
            
            // Check if it's a new day
            const isNewDay = !lastLogin || 
                lastLogin.getDate() !== now.getDate() ||
                lastLogin.getMonth() !== now.getMonth() ||
                lastLogin.getFullYear() !== now.getFullYear();
            
            if (isNewDay) {
                if (lastLogin) {
                    // Check streak
                    const daysDiff = Math.floor((now - lastLogin) / (1000 * 60 * 60 * 24));
                    if (daysDiff === 1) {
                        appState.user.dailyStreak++;
                        showAchievementToast('Streak Continued!', `${appState.user.dailyStreak} days 🔥`);
                    } else if (daysDiff > 1) {
                        if (appState.user.dailyStreak > 0) {
                            showFloatingText('Streak broken!', 'damage');
                        }
                        appState.user.dailyStreak = 1;
                    }
                } else {
                    appState.user.dailyStreak = 1;
                }
                
                // Reset daily quests
                appState.quests.forEach(quest => {
                    if (quest.type === 'daily') {
                        quest.progress = 0;
                        quest.completedToday = false;
                    }
                });
                
                // Reset daily habits
                appState.habits.forEach(habit => {
                    if (habit.type === 'daily') {
                        // Penalize for not doing dailies
                        if (habit.value > 0) {
                            habit.value = Math.max(-10, habit.value - 1);
                        }
                    }
                });
                
                // Full resource restore on new day
                appState.user.health = appState.user.maxHealth;
                appState.user.energy = appState.user.maxEnergy;
                appState.user.focus = appState.user.maxFocus;
                
                showFloatingText('New Day! Resources restored', 'heal');
            }
            
            appState.user.lastLoginDate = now.toISOString();
            saveToDB('userData', { id: 'currentUser', data: appState.user });
        }

        function initSkills() {
            // Skills already defined in appState, just need to check prerequisites
            updateSkillAvailability();
        }

        // ═══════════════════════════════════════════════════════════════
        // SERVICE WORKER REGISTRATION (Cache-First Strategy)
        // What: Offline functionality, asset caching, update management
        // How: Service worker lifecycle, cache strategies
        // Expected: Works offline, fast repeat visits, smart updates
        // ═══════════════════════════════════════════════════════════════
        
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                // Service worker would be registered here in production
                // For now, using inline caching strategy with IndexedDB
                console.log('Service Worker support detected - using IndexedDB for offline storage');
            });
        }

        // ═══════════════════════════════════════════════════════════════
        // KEYBOARD SHORTCUTS (MMO-style)
        // What: Quick access to common actions via keyboard
        // How: Event listeners, key combinations
        // Expected: Power user efficiency, accessibility boost
        // ═══════════════════════════════════════════════════════════════
        
        document.addEventListener('keydown', (e) => {
            // Character sheet: C key
            if (e.key === 'c' && !e.ctrlKey && !e.metaKey) {
                const activeElement = document.activeElement;
                if (activeElement.tagName !== 'INPUT' && activeElement.tagName !== 'TEXTAREA') {
                    openCharacterSheet();
                    e.preventDefault();
                }
            }
            
            // Inventory: I key
            if (e.key === 'i' && !e.ctrlKey && !e.metaKey) {
                const activeElement = document.activeElement;
                if (activeElement.tagName !== 'INPUT' && activeElement.tagName !== 'TEXTAREA') {
                    openCharacterSheet('inventory');
                    e.preventDefault();
                }
            }
            
            // Close modal: ESC key
            if (e.key === 'Escape') {
                closeCharacterSheet();
            }
            
            // Quest log: Q key
            if (e.key === 'q' && !e.ctrlKey && !e.metaKey) {
                const activeElement = document.activeElement;
                if (activeElement.tagName !== 'INPUT' && activeElement.tagName !== 'TEXTAREA') {
                    document.getElementById('quests-panel').scrollIntoView({ behavior: 'smooth' });
                    e.preventDefault();
                }
            }
        });
    </script>

    <!-- ═══════════════════════════════════════════════════════════════
         FOOTER & ATTRIBUTION
         What: Legal info, credits, contact information
         How: Semantic HTML, clear licensing
         Expected: Complete transparency, easy attribution
         ═══════════════════════════════════════════════════════════════ -->
    <footer style="margin-top: var(--space-2xl); padding: var(--space-xl); border-top: 2px solid var(--border-color); text-align: center; color: var(--text-secondary); position: relative; z-index: 1;">
        <div style="max-width: 800px; margin: 0 auto;">
            <h3 style="color: var(--text-primary); margin-bottom: var(--space-md);">Zero-Harm Declaration</h3>
            <p style="margin-bottom: var(--space-md); line-height: 1.8;">
                This platform is designed for <strong>education, restoration, and peaceful collaboration</strong>. 
                All tools and systems are built with <strong>anti-weaponization safeguards</strong> and respect for 
                <strong>community sovereignty</strong>. We reject extraction, coercion, and harm in all forms.
            </p>
            
            <h4 style="color: var(--text-primary); margin: var(--space-lg) 0 var(--space-sm);">Attribution & Licenses</h4>
            <p style="margin-bottom: var(--space-md);">
                Created by <strong>Foster + Navi</strong> | 
                <a href="https://planetaryrestorationarchive.com" style="color: var(--accent-primary);">Planetary Restoration Archive</a>
            </p>
            <p style="margin-bottom: var(--space-md);">
                <strong>License:</strong> MIT Open Source | 
                <strong>Analytics:</strong> Privacy-first, anonymized data sent to <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="7d1c191014133d0d111c1318091c0f040f180e09120f1c091412131c0f1e15140b18531e1210">[email&#160;protected]</a>
            </p>
            
            <div style="margin-top: var(--space-lg); font-size: 0.9rem; opacity: 0.8;">
                Built with: Vanilla JavaScript, IndexedDB, Canvas API, CSS Grid, Web Standards<br>
                      Zero external dependencies | Works offline | Respects your privacy
            </div>
        </div>
    </footer>
</body>
</html>
